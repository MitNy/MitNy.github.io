<!DOCTYPE html><html><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-W055DP4N3J"></script><script>
					window.dataLayer = window.dataLayer || [];
					function gtag(){dataLayer.push(arguments);}
					gtag('js', new Date());
					gtag('config', 'G-W055DP4N3J');</script><head><meta charSet="utf-8"/><meta name="description" content="기록 저장소"/><meta property="og:description" content="기록 저장소"/><meta property="og:url" content="https://mitny.github.io"/><meta property="og:type" content="website"/><meta property="og:locale" content="ko_KR"/><meta property="og:site_name" content="MitNy.log"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><title>[LOS] cobolt |  MitNy.log</title><meta name="robots" content="index,follow"/><meta property="og:title" content="[LOS] cobolt |  MitNy.log"/><link rel="canonical" href="https://mitny.github.io/articles/2017-08-10-LOS-cobolt"/><meta name="next-head-count" content="12"/><meta name="naver-site-verification" content="b408dee953bcbbb1038384f191f36dac0551c0fb"/><meta name="google-site-verification" content="vUtYhRYNCWYYTdurCRaVmtnWpPLuXKKwRAm5F6R9sNs"/><link rel="preload" href="/_next/static/css/e6a7c67d207b98b3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e6a7c67d207b98b3.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-005bdf76005efab4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-14a2a9a26060c1d3.js" defer=""></script><script src="/_next/static/chunks/401-9f1400d964d6d7ce.js" defer=""></script><script src="/_next/static/chunks/pages/articles/%5Bdir_slug%5D/%5Bslug%5D-0b7b92862b8a360a.js" defer=""></script><script src="/_next/static/nJPyYqODS0udXw2rMLLyn/_buildManifest.js" defer=""></script><script src="/_next/static/nJPyYqODS0udXw2rMLLyn/_ssgManifest.js" defer=""></script></head><link rel="apple-touch-icon" sizes="57x57" href="/favicon/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/favicon/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/favicon/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/favicon/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/favicon/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/favicon/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/favicon/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/favicon/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/favicon/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/manifest.json"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-TileImage" content="/favicon/ms-icon-144x144.png"/><meta name="theme-color" content="#ffffff"/><body><div id="__next" data-reactroot=""><div class="header h-16 bg-white drop-shadow-md text-black"><div class="mx-10 pt-3 cursor-pointer"><p class="header-home text-3xl float-left">MitNy.log</p><p class="text-base font-bold pt-2 float-right">About</p></div></div><div class="mx-10 my-8"><div class="w-full min-h-screen pb-24 mt-8"><div class="w-full min-h-screen pb-24 mt-8"><article class="prose max-w-none"><div class="border-b"><p class="text-4xl font-bold mb-0">[LOS] cobolt</p><p class="text-xs text-neutral-500"></p></div><div><p><img src="/assets/posts/los/cobolt.png" alt=""></p>
<p>첫번째 문제 gremlin을 풀고 cobolt로 넘어오면 gremlin과 비슷한 쿼리문이 있다.</p>
<p><code>query: select id from prob_cobolt where id='' and pw=md5('')</code></p>
<pre class="language-php"><code class="language-php code-highlight"><span class="code-line"><span class="token php language-php"><span class="token delimiter important">&#x3C;?php</span>
</span></span><span class="code-line"><span class="token php language-php">
</span></span><span class="code-line"><span class="token php language-php">  <span class="token keyword">include</span> <span class="token string double-quoted-string">"./config.php"</span><span class="token punctuation">;</span> 
</span></span><span class="code-line"><span class="token php language-php">  <span class="token function">login_chk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="code-line"><span class="token php language-php">  <span class="token function">dbconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="code-line"><span class="token php language-php">  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token global">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"No Hack ~_~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</span></span><span class="code-line"><span class="token php language-php">  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/prob|_|\.|\(\)/i'</span><span class="token punctuation">,</span> <span class="token global">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"No Hack ~_~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</span></span><span class="code-line"><span class="token php language-php">  <span class="token variable">$query</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id from prob_cobolt where id='<span class="token interpolation"><span class="token punctuation">{</span><span class="token global">$_GET</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">}</span></span>' and pw=md5('<span class="token interpolation"><span class="token punctuation">{</span><span class="token global">$_GET</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">}</span></span>')"</span><span class="token punctuation">;</span> 
</span></span><span class="code-line"><span class="token php language-php">  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&#x3C;hr>query : &#x3C;strong><span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$query</span><span class="token punctuation">}</span></span>&#x3C;/strong>&#x3C;hr>&#x3C;br>"</span><span class="token punctuation">;</span> 
</span></span><span class="code-line"><span class="token php language-php">  <span class="token variable">$result</span> <span class="token operator">=</span> @<span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</span></span><span class="code-line"><span class="token php language-php">  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"cobolt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="code-line"><span class="token php language-php">  <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&#x3C;h2>Hello <span class="token interpolation"><span class="token punctuation">{</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>&#x3C;br>You are not admin :(&#x3C;/h2>"</span><span class="token punctuation">;</span> 
</span></span><span class="code-line"><span class="token php language-php">  <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</span></span><span class="code-line"><span class="token php language-php"><span class="token delimiter important">?></span></span>
</span></code></pre>
<p>gremlin과 달라진 점이라면 id가 admin이어야 풀린다. 그리고 pw는 md5로 암호화된다.
gremlin에선 pw를 참으로 만들어줬지만, 이번엔 id가 admin이어야 하고, pw가 md5로 암호화 된다는 전제가 있으니
id는 admin으로 넣어주되, pw 부분을 주석 처리 해주는 방식으로 풀었다.</p>
<p><code>?id=admin%27or%271=1%20--</code></p>
<p>이런식으로 값을 넣으면 쿼리문은 다음과 같다.</p>
<p><img src="/assets/posts/los/cobolt_clear.png" alt=""></p>
<p>코볼트 클리어!</p></div></article></div></div></div><footer class="h-16 bg-neutral-500"></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"2017-08-10-LOS-cobolt","content":"![](/assets/posts/los/cobolt.png)\n\n첫번째 문제 gremlin을 풀고 cobolt로 넘어오면 gremlin과 비슷한 쿼리문이 있다.\n\n`query: select id from prob_cobolt where id='' and pw=md5('')`\n\n```php\n\u003c?php\n\n  include \"./config.php\"; \n  login_chk();\n  dbconnect();\n  if(preg_match('/prob|_|\\.|\\(\\)/i', $_GET[id])) exit(\"No Hack ~_~\"); \n  if(preg_match('/prob|_|\\.|\\(\\)/i', $_GET[pw])) exit(\"No Hack ~_~\"); \n  $query = \"select id from prob_cobolt where id='{$_GET[id]}' and pw=md5('{$_GET[pw]}')\"; \n  echo \"\u003chr\u003equery : \u003cstrong\u003e{$query}\u003c/strong\u003e\u003chr\u003e\u003cbr\u003e\"; \n  $result = @mysql_fetch_array(mysql_query($query)); \n  if($result['id'] == 'admin') solve(\"cobolt\");\n  elseif($result['id']) echo \"\u003ch2\u003eHello {$result['id']}\u003cbr\u003eYou are not admin :(\u003c/h2\u003e\"; \n  highlight_file(__FILE__); \n?\u003e\n```\n\ngremlin과 달라진 점이라면 id가 admin이어야 풀린다. 그리고 pw는 md5로 암호화된다.\ngremlin에선 pw를 참으로 만들어줬지만, 이번엔 id가 admin이어야 하고, pw가 md5로 암호화 된다는 전제가 있으니\nid는 admin으로 넣어주되, pw 부분을 주석 처리 해주는 방식으로 풀었다.\n\n`?id=admin%27or%271=1%20--`\n\n이런식으로 값을 넣으면 쿼리문은 다음과 같다.\n\n![](/assets/posts/los/cobolt_clear.png)\n\n코볼트 클리어!\n","layout":"post","title":"[LOS] cobolt","categories":["LOS"],"excerpt":" ","comments":true,"share":true,"tags":["LOS","Web-hacking","cobolt","write-up"]}},"__N_SSG":true},"page":"/articles/[dir_slug]/[slug]","query":{"dir_slug":"2017-08","slug":"LOS-cobolt"},"buildId":"nJPyYqODS0udXw2rMLLyn","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>