<!DOCTYPE html><html><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-W055DP4N3J"></script><script>
					window.dataLayer = window.dataLayer || [];
					function gtag(){dataLayer.push(arguments);}
					gtag('js', new Date());
					gtag('config', 'G-W055DP4N3J');</script><head><meta charSet="utf-8"/><meta name="description" content="기록 저장소"/><meta property="og:description" content="기록 저장소"/><meta property="og:url" content="https://mitny.github.io"/><meta property="og:type" content="website"/><meta property="og:locale" content="ko_KR"/><meta property="og:site_name" content="MitNy.log"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><title>[Ubuntu] Ubuntu 16.04 Let&#x27;s Encrypt로 https 설정하기 |  MitNy.log</title><meta name="robots" content="index,follow"/><meta property="og:title" content="[Ubuntu] Ubuntu 16.04 Let&#x27;s Encrypt로 https 설정하기 |  MitNy.log"/><link rel="canonical" href="https://mitny.github.io/articles/2019-01-24-LetsEncrypt"/><meta name="next-head-count" content="12"/><meta name="naver-site-verification" content="b408dee953bcbbb1038384f191f36dac0551c0fb"/><meta name="google-site-verification" content="vUtYhRYNCWYYTdurCRaVmtnWpPLuXKKwRAm5F6R9sNs"/><link rel="preload" href="/_next/static/css/e6a7c67d207b98b3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e6a7c67d207b98b3.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-005bdf76005efab4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-14a2a9a26060c1d3.js" defer=""></script><script src="/_next/static/chunks/401-9f1400d964d6d7ce.js" defer=""></script><script src="/_next/static/chunks/pages/articles/%5Bdir_slug%5D/%5Bslug%5D-0b7b92862b8a360a.js" defer=""></script><script src="/_next/static/nJPyYqODS0udXw2rMLLyn/_buildManifest.js" defer=""></script><script src="/_next/static/nJPyYqODS0udXw2rMLLyn/_ssgManifest.js" defer=""></script></head><link rel="apple-touch-icon" sizes="57x57" href="/favicon/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/favicon/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/favicon/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/favicon/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/favicon/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/favicon/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/favicon/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/favicon/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/favicon/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/manifest.json"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-TileImage" content="/favicon/ms-icon-144x144.png"/><meta name="theme-color" content="#ffffff"/><body><div id="__next" data-reactroot=""><div class="header h-16 bg-white drop-shadow-md text-black"><div class="mx-10 pt-3 cursor-pointer"><p class="header-home text-3xl float-left">MitNy.log</p><p class="text-base font-bold pt-2 float-right">About</p></div></div><div class="mx-10 my-8"><div class="w-full min-h-screen pb-24 mt-8"><div class="w-full min-h-screen pb-24 mt-8"><article class="prose max-w-none"><div class="border-b"><p class="text-4xl font-bold mb-0">[Ubuntu] Ubuntu 16.04 Let&#x27;s Encrypt로 https 설정하기</p><p class="text-xs text-neutral-500"></p></div><div><p>지난번에 OpenSSL을 통해 https로 접속을 할 수 있도록 설정한 사이트가 있었는데
'연결이 비공개로 설정되어 있지 않습니다.' 라는 메시지를 보고 싶지 않아서
<code>Let's Encrypt</code>를 사용하려고 한다.</p>
<h3 id="lets-encrypt-설치하기">Let's Encrypt 설치하기</h3>
<ol>
<li>apt-get install letsencrypt
<img src="/assets/posts/ubuntu/letsencryptInstall.png" alt=""></li>
</ol>
<h3 id="인증서-발급-받기">인증서 발급 받기</h3>
<ol>
<li>letsencrypt certonly --webroot --webroot-path=/var/www/html -d domain.com</li>
</ol>
<ul>
<li>d 옵션으로 인증할 도메인의 주소를 설정할 수 있다. <code>-d domain -d domain</code> 처럼 다수의 도메인도 한 번에 설정할 수 있다.</li>
<li>webroot-path에는 웹 서버의 기본 경로로 설정해주었다.</li>
</ul>
<p>위 명령을 실행하면 다음과 같이 인증 만료 알림이나 키 복구를 위한 이메일을 입력하는 창이 뜬다.
<img src="/assets/posts/ubuntu/letsEmail.png" alt=""></p>
<p>이메일 입력 후 동의하면 완료된다.
<img src="/assets/posts/ubuntu/letsAgree.png" alt=""></p>
<p>인증서 발급이 성공적으로 끝나면 다음 메시지가 뜬다.
<img src="/assets/posts/ubuntu/letsNote.png" alt=""></p>
<p>인증서의 위치는 <code>/etc/letsencrypt/live/[domain]/</code> 위치에 있다</p>
<ul>
<li>cert.pem : 인증서 파일</li>
<li>chain.pem : 인증서 발급자 파일</li>
<li>fullchain.pem : cert.pem+chain.pem</li>
<li>privkey.pem : 인증암호를 복호화하는 개인키</li>
</ul>
<p><img src="/assets/posts/ubuntu/letsDir.png" alt=""></p>
<h3 id="인증서-설정하기">인증서 설정하기</h3>
<ol>
<li>/etc/apache2/sites-abailable/default-ssl.conf 파일 복사</li>
</ol>
<ul>
<li>default-ssl.conf 파일을 [domain].conf 나 아무 파일명을 써서 복사한다.</li>
<li>이 글에선 back-ssl.conf를 사용합니다.
<code>sudo cp /etc/apache2/sites-available/default-ssl.conf /etc/apache2/sites-available/back-ssl.conf</code></li>
</ul>
<ol start="2">
<li>복사한 conf 파일 수정(back-ssl.conf 수정)</li>
</ol>
<ul>
<li>
<p>SSLEngine on</p>
</li>
<li>
<p>SSLProtocol all -SSLv2 -SSLv3</p>
</li>
<li>
<p>SSLCipherSuite ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA</p>
</li>
<li>
<p>SSLHonorCipherOrder on</p>
</li>
<li>
<p>SSLCertificateFile "/etc/letsencrypt/live/[폴더명]/cert.pem"</p>
</li>
<li>
<p>SSLCertificateKeyFile "/etc/letsencrypt/live/[폴더명]/privkey.pem"</p>
</li>
<li>
<p>SSLCertificateChainFile "/etc/letsencrypt/live/[폴더명]/chain.pem"</p>
</li>
<li>
<p>SSLOptions +FakeBasicAuth +ExportCertData +StrictRequire 주석 해제</p>
</li>
</ul>
<p><img src="/assets/posts/ubuntu/letsSSL.png" alt="">
<img src="/assets/posts/ubuntu/letsConfig.png" alt=""></p>
<ol start="3">
<li>
<p>SSL 모듈 활성화
<code>sudo a2enmod ssl</code></p>
</li>
<li>
<p>back-ssl 활성화
<code>sudo a2ensite back-ssl</code></p>
</li>
<li>
<p>443 포트 접속 허용하기
<code>sudo ufw allow 443/tcp</code></p>
</li>
<li>
<p>apache 재시작
<code>sudo service apache2 restart</code></p>
</li>
</ol>
<h3 id="사이트-접속-확인">사이트 접속 확인</h3>
<p>크롬 주소창에 '주의 요함','이 사이트는 보안 연결(HTTPS)이 사용되지 않았습니다.' 같은 메시지가 더 이상 뜨지 않는다.
<img src="/assets/posts/ubuntu/letsPage.png" alt=""></p>
<p>다음은 http -> https 리다이렉션을 할 생각이다.</p></div></article></div></div></div><footer class="h-16 bg-neutral-500"></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"2019-01-24-LetsEncrypt","content":"\n지난번에 OpenSSL을 통해 https로 접속을 할 수 있도록 설정한 사이트가 있었는데\n'연결이 비공개로 설정되어 있지 않습니다.' 라는 메시지를 보고 싶지 않아서\n`Let's Encrypt`를 사용하려고 한다.\n\n\n### Let's Encrypt 설치하기\n1. apt-get install letsencrypt\n![](/assets/posts/ubuntu/letsencryptInstall.png)\n\n### 인증서 발급 받기\n1. letsencrypt certonly --webroot --webroot-path=/var/www/html -d domain.com\n- d 옵션으로 인증할 도메인의 주소를 설정할 수 있다. `-d domain -d domain` 처럼 다수의 도메인도 한 번에 설정할 수 있다.\n- webroot-path에는 웹 서버의 기본 경로로 설정해주었다.\n\n위 명령을 실행하면 다음과 같이 인증 만료 알림이나 키 복구를 위한 이메일을 입력하는 창이 뜬다.\n![](/assets/posts/ubuntu/letsEmail.png)\n\n이메일 입력 후 동의하면 완료된다.\n![](/assets/posts/ubuntu/letsAgree.png)\n\n\n인증서 발급이 성공적으로 끝나면 다음 메시지가 뜬다.\n![](/assets/posts/ubuntu/letsNote.png)\n\n인증서의 위치는 `/etc/letsencrypt/live/[domain]/` 위치에 있다\n- cert.pem : 인증서 파일\n- chain.pem : 인증서 발급자 파일\n- fullchain.pem : cert.pem+chain.pem\n- privkey.pem : 인증암호를 복호화하는 개인키\n\n![](/assets/posts/ubuntu/letsDir.png)\n\n### 인증서 설정하기\n1. /etc/apache2/sites-abailable/default-ssl.conf 파일 복사\n- default-ssl.conf 파일을 [domain].conf 나 아무 파일명을 써서 복사한다.\n- 이 글에선 back-ssl.conf를 사용합니다.\n`sudo cp /etc/apache2/sites-available/default-ssl.conf /etc/apache2/sites-available/back-ssl.conf`\n\n2. 복사한 conf 파일 수정(back-ssl.conf 수정)\n\n- SSLEngine on\n- SSLProtocol all -SSLv2 -SSLv3\n- SSLCipherSuite ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA\n \n- SSLHonorCipherOrder on\n \n- SSLCertificateFile \"/etc/letsencrypt/live/[폴더명]/cert.pem\"\n- SSLCertificateKeyFile \"/etc/letsencrypt/live/[폴더명]/privkey.pem\"\n- SSLCertificateChainFile \"/etc/letsencrypt/live/[폴더명]/chain.pem\"\n- SSLOptions +FakeBasicAuth +ExportCertData +StrictRequire 주석 해제\n\n![](/assets/posts/ubuntu/letsSSL.png)\n![](/assets/posts/ubuntu/letsConfig.png)\n\n3. SSL 모듈 활성화\n`sudo a2enmod ssl`\n\n4. back-ssl 활성화\n`sudo a2ensite back-ssl`\n\n5. 443 포트 접속 허용하기\n`sudo ufw allow 443/tcp`\n\n6. apache 재시작\n`sudo service apache2 restart`\n\n### 사이트 접속 확인\n크롬 주소창에 '주의 요함','이 사이트는 보안 연결(HTTPS)이 사용되지 않았습니다.' 같은 메시지가 더 이상 뜨지 않는다.\n![](/assets/posts/ubuntu/letsPage.png)\n\n다음은 http -\u003e https 리다이렉션을 할 생각이다.\n","layout":"post","title":"[Ubuntu] Ubuntu 16.04 Let's Encrypt로 https 설정하기","categories":["Ubuntu"],"excerpt":" ","comments":true,"share":true,"tags":["Ubuntu","SSL","HTTPS"]}},"__N_SSG":true},"page":"/articles/[dir_slug]/[slug]","query":{"dir_slug":"2019-01","slug":"LetsEncrypt"},"buildId":"nJPyYqODS0udXw2rMLLyn","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>