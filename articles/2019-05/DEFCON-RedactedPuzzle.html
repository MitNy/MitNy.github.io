<!DOCTYPE html><html><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-W055DP4N3J"></script><script>
					window.dataLayer = window.dataLayer || [];
					function gtag(){dataLayer.push(arguments);}
					gtag('js', new Date());
					gtag('config', 'G-W055DP4N3J');</script><head><meta charSet="utf-8"/><meta name="description" content="기록 저장소"/><meta property="og:description" content="기록 저장소"/><meta property="og:url" content="https://mitny.github.io"/><meta property="og:type" content="website"/><meta property="og:locale" content="ko_KR"/><meta property="og:site_name" content="MitNy.log"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><title>[DEFCON 2019 Quals] Redacted-Puzzle |  MitNy.log</title><meta name="robots" content="index,follow"/><meta property="og:title" content="[DEFCON 2019 Quals] Redacted-Puzzle |  MitNy.log"/><link rel="canonical" href="https://mitny.github.io/articles/2019-05-18-DEFCON-RedactedPuzzle"/><meta name="next-head-count" content="12"/><meta name="naver-site-verification" content="b408dee953bcbbb1038384f191f36dac0551c0fb"/><meta name="google-site-verification" content="vUtYhRYNCWYYTdurCRaVmtnWpPLuXKKwRAm5F6R9sNs"/><link rel="preload" href="/_next/static/css/e6a7c67d207b98b3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e6a7c67d207b98b3.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-005bdf76005efab4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-14a2a9a26060c1d3.js" defer=""></script><script src="/_next/static/chunks/401-9f1400d964d6d7ce.js" defer=""></script><script src="/_next/static/chunks/pages/articles/%5Bdir_slug%5D/%5Bslug%5D-0b7b92862b8a360a.js" defer=""></script><script src="/_next/static/nJPyYqODS0udXw2rMLLyn/_buildManifest.js" defer=""></script><script src="/_next/static/nJPyYqODS0udXw2rMLLyn/_ssgManifest.js" defer=""></script></head><link rel="apple-touch-icon" sizes="57x57" href="/favicon/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/favicon/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/favicon/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/favicon/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/favicon/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/favicon/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/favicon/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/favicon/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/favicon/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/manifest.json"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-TileImage" content="/favicon/ms-icon-144x144.png"/><meta name="theme-color" content="#ffffff"/><body><div id="__next" data-reactroot=""><div class="header h-16 bg-white drop-shadow-md text-black"><div class="mx-10 pt-3 cursor-pointer"><p class="header-home text-3xl float-left">MitNy.log</p><p class="text-base font-bold pt-2 float-right">About</p></div></div><div class="mx-10 my-8"><div class="w-full min-h-screen pb-24 mt-8"><div class="w-full min-h-screen pb-24 mt-8"><article class="prose max-w-none"><div class="border-b"><p class="text-4xl font-bold mb-0">[DEFCON 2019 Quals] Redacted-Puzzle</p><p class="text-xs text-neutral-500"></p></div><div><p>DEFCON 2019 Quals에 출제된 potpourri라는 분야의  Redacted-Puzzle 문제이다 최종 포인트는 110.</p>
<!--more-->
<p><code>redacted</code>는 수정 된, 편집된 등의 뜻을 가지며 주로 redaction은 <code>black out(검게 지우는 것)</code> 과정을 거친다.</p>
<p><img src="/assets/posts/ctf/DEFCON2019/redacted-puzzle.gif" alt="">
문제 파일도 검게 칠해져 있는 걸 확인할 수 있다.</p>
<p><img src="/assets/posts/ctf/DEFCON2019/puzzle_frame.png" alt="">
<code>exiftool redacted-puzzle.gif</code> 명령으로 파일에 대한 정보를 알아냈다.
프레임 수가 총 35개라는 것을 알 수 있다.</p>
<p><img src="/assets/posts/ctf/DEFCON2019/puzzle_identify.png" alt="">
<code>identify -verbose redacted-puzzle.gif</code> 명령으로 각 프레임의 colormap을 확인할 수 있다.</p>
<p>gif 파일을 각 프레임별로 추출해내면 총 35개의 이미지들이 있다.
<img src="/assets/posts/ctf/DEFCON2019/puzzle_convert.png" alt=""></p>
<p><img src="/assets/posts/ctf/DEFCON2019/0.png" alt=""></p>
<p>첫번째 이미지를 보면 <code>FLAG ALPHABEY: +-=ABCDEFGHIJKLMNOPQRSTUVWXYZ_{}</code>로 플래그가 어떤 형태인지 알려준다.
처음에 이 이미지들을 보고 대체 뭐지 싶었는데 8각형의 꼭지점과 일치하면 1, 아니면 0의 값을 의미한다고 한다.</p>
<p>팔각형과 겹쳐보면 다음과 같다.
<img src="/assets/posts/ctf/DEFCON2019/0_edge.png" alt="">
<img src="/assets/posts/ctf/DEFCON2019/16_edge.png" alt=""></p>
<p>이런 과정을 반복해 모든 이미지의 값으로 리스트를 만들어준다.</p>
<pre><code class="code-highlight"><span class="code-line">['10001100', '01100011', '11100100', '01000110', '10000101', '00111101', '01000010', '10011000', '11100000', '11110100', '10000000', '00101101', '01110010', '00011100', '00001000', '10100101', '11010111', '01101110', '10100110', '10010001', '10111100', '10000100', '10000001', '10111001', '11010100', '00111011', '11001110', '11110010', '00011110', '10011101', '11001001', '11000111', '01100101', '00011110', '10011111']
</span></code></pre>
<p>위 값들을 하나의 변수로 합치면 이렇게 된다.</p>
<pre><code class="code-highlight"><span class="code-line">1000110001100011111001000100011010000101001111010100001010011000111000001111010010000000001011010111001000011100000010001010010111010111011011101010011010010001101111001000010010000001101110011101010000111011110011101111001000011110100111011100100111000111011001010001111010011111
</span></code></pre>
<p>DEFCON CTF의 플래그 형식은 OOO{} 인데, 앞 부분에 <code>100011000110001</code> 이렇게 똑같은 문자로 보이는 패턴이 있다.
이 부분만 우선 변환해보면 <code>10001 -> 17(DEC)</code> 이다. ASCII도 아니고 이건 또 무슨 의미인가.. 했다 ㅎㅎ</p>
<p>위에서 언급한 <code>+-=ABCDEFGHIJKLMNOPQRSTUVWXYZ_{}</code>를 +부터 0으로 세면 17은 O이다.
이렇게 하면 171717은 OOO 이므로 플래그 형식처럼 생겼다!
코드로 짜는게 더 편할 것 같다.</p>
<pre class="language-python"><code class="language-python code-highlight"><span class="code-line">vertex <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'10001100'</span><span class="token punctuation">,</span> <span class="token string">'01100011'</span><span class="token punctuation">,</span> <span class="token string">'11100100'</span><span class="token punctuation">,</span> <span class="token string">'01000110'</span><span class="token punctuation">,</span> <span class="token string">'10000101'</span><span class="token punctuation">,</span> <span class="token string">'00111101'</span><span class="token punctuation">,</span> <span class="token string">'01000010'</span><span class="token punctuation">,</span> <span class="token string">'10011000'</span><span class="token punctuation">,</span> <span class="token string">'11100000'</span><span class="token punctuation">,</span> <span class="token string">'11110100'</span><span class="token punctuation">,</span> <span class="token string">'10000000'</span><span class="token punctuation">,</span> <span class="token string">'00101101'</span><span class="token punctuation">,</span> <span class="token string">'01110010'</span><span class="token punctuation">,</span> <span class="token string">'00011100'</span><span class="token punctuation">,</span> <span class="token string">'00001000'</span><span class="token punctuation">,</span> <span class="token string">'10100101'</span><span class="token punctuation">,</span> <span class="token string">'11010111'</span><span class="token punctuation">,</span> <span class="token string">'01101110'</span><span class="token punctuation">,</span> <span class="token string">'10100110'</span><span class="token punctuation">,</span> <span class="token string">'10010001'</span><span class="token punctuation">,</span> <span class="token string">'10111100'</span><span class="token punctuation">,</span> <span class="token string">'10000100'</span><span class="token punctuation">,</span> <span class="token string">'10000001'</span><span class="token punctuation">,</span> <span class="token string">'10111001'</span><span class="token punctuation">,</span> <span class="token string">'11010100'</span><span class="token punctuation">,</span> <span class="token string">'00111011'</span><span class="token punctuation">,</span> <span class="token string">'11001110'</span><span class="token punctuation">,</span> <span class="token string">'11110010'</span><span class="token punctuation">,</span> <span class="token string">'00011110'</span><span class="token punctuation">,</span> <span class="token string">'10011101'</span><span class="token punctuation">,</span> <span class="token string">'11001001'</span><span class="token punctuation">,</span> <span class="token string">'11000111'</span><span class="token punctuation">,</span> <span class="token string">'01100101'</span><span class="token punctuation">,</span> <span class="token string">'00011110'</span><span class="token punctuation">,</span> <span class="token string">'10011111'</span><span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line">vertex_join <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>vertex<span class="token punctuation">)</span>
</span><span class="code-line">result <span class="token operator">=</span> <span class="token string">""</span>
</span><span class="code-line">
</span><span class="code-line">flag_alphabet <span class="token operator">=</span> <span class="token string">"+-=ABCDEFGHIJKLMNOPQRSTUVWXYZ_{}"</span>
</span><span class="code-line"><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>vertex_join<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">    tmp <span class="token operator">=</span> vertex_join<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">]</span>
</span><span class="code-line">    index <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># Binary to Decimal</span>
</span><span class="code-line">    result <span class="token operator">+=</span> flag_alphabet<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
</span></code></pre>
<p>바이너리를 합친 문자열을 5개씩 끊어 10진수로 변환 후, flag_alphabet의 해당하는 인덱스의 값을 다 더한다.</p>
<p><img src="/assets/posts/ctf/DEFCON2019/puzzle_flag.png" alt=""></p>
<p>플래그:)</p></div></article></div></div></div><footer class="h-16 bg-neutral-500"></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"2019-05-18-DEFCON-RedactedPuzzle","content":"\r\nDEFCON 2019 Quals에 출제된 potpourri라는 분야의  Redacted-Puzzle 문제이다 최종 포인트는 110.\r\n\r\n\u003c!--more--\u003e\r\n\r\n`redacted`는 수정 된, 편집된 등의 뜻을 가지며 주로 redaction은 `black out(검게 지우는 것)` 과정을 거친다.\r\n\r\n![](/assets/posts/ctf/DEFCON2019/redacted-puzzle.gif)\r\n문제 파일도 검게 칠해져 있는 걸 확인할 수 있다.\r\n\r\n![](/assets/posts/ctf/DEFCON2019/puzzle_frame.png)\r\n`exiftool redacted-puzzle.gif` 명령으로 파일에 대한 정보를 알아냈다.\r\n프레임 수가 총 35개라는 것을 알 수 있다.\r\n\r\n![](/assets/posts/ctf/DEFCON2019/puzzle_identify.png)\r\n`identify -verbose redacted-puzzle.gif` 명령으로 각 프레임의 colormap을 확인할 수 있다.\r\n\r\ngif 파일을 각 프레임별로 추출해내면 총 35개의 이미지들이 있다.\r\n![](/assets/posts/ctf/DEFCON2019/puzzle_convert.png)\r\n\r\n![](/assets/posts/ctf/DEFCON2019/0.png)\r\n\r\n첫번째 이미지를 보면 `FLAG ALPHABEY: +-=ABCDEFGHIJKLMNOPQRSTUVWXYZ_{}`로 플래그가 어떤 형태인지 알려준다.\r\n처음에 이 이미지들을 보고 대체 뭐지 싶었는데 8각형의 꼭지점과 일치하면 1, 아니면 0의 값을 의미한다고 한다.\r\n\r\n팔각형과 겹쳐보면 다음과 같다.\r\n![](/assets/posts/ctf/DEFCON2019/0_edge.png)\r\n![](/assets/posts/ctf/DEFCON2019/16_edge.png)\r\n\r\n이런 과정을 반복해 모든 이미지의 값으로 리스트를 만들어준다.\r\n\r\n```\r\n['10001100', '01100011', '11100100', '01000110', '10000101', '00111101', '01000010', '10011000', '11100000', '11110100', '10000000', '00101101', '01110010', '00011100', '00001000', '10100101', '11010111', '01101110', '10100110', '10010001', '10111100', '10000100', '10000001', '10111001', '11010100', '00111011', '11001110', '11110010', '00011110', '10011101', '11001001', '11000111', '01100101', '00011110', '10011111']\r\n```\r\n\r\n위 값들을 하나의 변수로 합치면 이렇게 된다.\r\n```\r\n1000110001100011111001000100011010000101001111010100001010011000111000001111010010000000001011010111001000011100000010001010010111010111011011101010011010010001101111001000010010000001101110011101010000111011110011101111001000011110100111011100100111000111011001010001111010011111\r\n```\r\n\r\nDEFCON CTF의 플래그 형식은 OOO{} 인데, 앞 부분에 `100011000110001` 이렇게 똑같은 문자로 보이는 패턴이 있다.\r\n이 부분만 우선 변환해보면 `10001 -\u003e 17(DEC)` 이다. ASCII도 아니고 이건 또 무슨 의미인가.. 했다 ㅎㅎ\r\n\r\n위에서 언급한 `+-=ABCDEFGHIJKLMNOPQRSTUVWXYZ_{}`를 +부터 0으로 세면 17은 O이다. \r\n이렇게 하면 171717은 OOO 이므로 플래그 형식처럼 생겼다!\r\n코드로 짜는게 더 편할 것 같다.\r\n\r\n```python\r\nvertex = ['10001100', '01100011', '11100100', '01000110', '10000101', '00111101', '01000010', '10011000', '11100000', '11110100', '10000000', '00101101', '01110010', '00011100', '00001000', '10100101', '11010111', '01101110', '10100110', '10010001', '10111100', '10000100', '10000001', '10111001', '11010100', '00111011', '11001110', '11110010', '00011110', '10011101', '11001001', '11000111', '01100101', '00011110', '10011111']\r\n\r\nvertex_join = \"\".join(vertex)\r\nresult = \"\"\r\n\r\nflag_alphabet = \"+-=ABCDEFGHIJKLMNOPQRSTUVWXYZ_{}\"\r\nfor i in range(0,len(vertex_join),5):\r\n    tmp = vertex_join[i:i+5]\r\n    index = int(tmp,2) # Binary to Decimal\r\n    result += flag_alphabet[index]\r\n\r\nprint(result)\r\n```\r\n\r\n바이너리를 합친 문자열을 5개씩 끊어 10진수로 변환 후, flag_alphabet의 해당하는 인덱스의 값을 다 더한다.\r\n\r\n![](/assets/posts/ctf/DEFCON2019/puzzle_flag.png)\r\n\r\n플래그:)\r\n\r\n\r\n\r\n","layout":"post","title":"[DEFCON 2019 Quals] Redacted-Puzzle","categories":["CTF"],"excerpt":" ","comments":true,"share":true,"tags":["CTF","Write-up"]}},"__N_SSG":true},"page":"/articles/[dir_slug]/[slug]","query":{"dir_slug":"2019-05","slug":"DEFCON-RedactedPuzzle"},"buildId":"nJPyYqODS0udXw2rMLLyn","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>