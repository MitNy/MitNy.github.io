<!DOCTYPE html><html><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-W055DP4N3J"></script><script>
					window.dataLayer = window.dataLayer || [];
					function gtag(){dataLayer.push(arguments);}
					gtag('js', new Date());
					gtag('config', 'G-W055DP4N3J');</script><head><meta charSet="utf-8"/><meta name="description" content="기록 저장소"/><meta property="og:description" content="기록 저장소"/><meta property="og:url" content="https://mitny.github.io"/><meta property="og:type" content="website"/><meta property="og:locale" content="ko_KR"/><meta property="og:site_name" content="MitNy.log"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><title>[MySQL] MySQL 데이터를 구글 스프레드 시트로 불러오기 |  MitNy.log</title><meta name="robots" content="index,follow"/><meta property="og:title" content="[MySQL] MySQL 데이터를 구글 스프레드 시트로 불러오기 |  MitNy.log"/><link rel="canonical" href="https://mitny.github.io/articles/2019-04-15-MySQL-to-Googlespreadsheet"/><meta name="next-head-count" content="12"/><meta name="naver-site-verification" content="b408dee953bcbbb1038384f191f36dac0551c0fb"/><meta name="google-site-verification" content="vUtYhRYNCWYYTdurCRaVmtnWpPLuXKKwRAm5F6R9sNs"/><link rel="preload" href="/_next/static/css/e6a7c67d207b98b3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e6a7c67d207b98b3.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-005bdf76005efab4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-14a2a9a26060c1d3.js" defer=""></script><script src="/_next/static/chunks/401-9f1400d964d6d7ce.js" defer=""></script><script src="/_next/static/chunks/pages/articles/%5Bdir_slug%5D/%5Bslug%5D-0b7b92862b8a360a.js" defer=""></script><script src="/_next/static/nJPyYqODS0udXw2rMLLyn/_buildManifest.js" defer=""></script><script src="/_next/static/nJPyYqODS0udXw2rMLLyn/_ssgManifest.js" defer=""></script></head><link rel="apple-touch-icon" sizes="57x57" href="/favicon/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/favicon/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/favicon/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/favicon/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/favicon/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/favicon/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/favicon/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/favicon/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/favicon/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/manifest.json"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-TileImage" content="/favicon/ms-icon-144x144.png"/><meta name="theme-color" content="#ffffff"/><body><div id="__next" data-reactroot=""><div class="header h-16 bg-white drop-shadow-md text-black"><div class="mx-10 pt-3 cursor-pointer"><p class="header-home text-3xl float-left">MitNy.log</p><p class="text-base font-bold pt-2 float-right">About</p></div></div><div class="mx-10 my-8"><div class="w-full min-h-screen pb-24 mt-8"><div class="w-full min-h-screen pb-24 mt-8"><article class="prose max-w-none"><div class="border-b"><p class="text-4xl font-bold mb-0">[MySQL] MySQL 데이터를 구글 스프레드 시트로 불러오기</p><p class="text-xs text-neutral-500"></p></div><div><p>MySQL 테이블 데이터를 구글 스프레드 시트로 만들어야 하는데 일일이 하긴 번거로워서<br>
구글 스프레드의 스크립트 기능을 이용해 커넥션을 생성, 데이터를 불러오는 코드를 짰다.<br>
이렇게 귀찮음을 코드로 푸는 나를 보면서 정말 컴공스럽다라는 생각이 든다....<br></p>
<p>보안상의 이유로 실제 테이블 대신 블로그용 테스트 테이블을 사용했다. 테이블 구조는 다음과 같다.
<img src="/assets/posts/mysql/eduboard.png" alt=""></p>
<p>우선 외부에서 데이터베이스에 접속할 수 있도록 설정을 해주어야 한다.
그 부분은 <a href="https://idchowto.com/?p=11068" target="_blank" rel="noopener noreferrer">이곳에서</a></p>
<p>설정이 끝나면 구글 스프레드 시트를 하나 만들고 <code>도구 > 스크립트 편집기</code>에 들어간다.
<img src="/assets/posts/mysql/sheet_tools.png" alt=""></p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token operator">&#x3C;</span>script src<span class="token operator">=</span><span class="token string">"https://gist.github.com/e6129c9fd9bc74e814d0?file-pull-and-sync-data-between-google-doc-spreadsheet-and-mysql-gs"</span> type<span class="token operator">=</span><span class="token string">"text/javascript"</span><span class="token operator">/</span><span class="token operator">></span>
</span><span class="code-line"><span class="token keyword">var</span> connectionName <span class="token operator">=</span> <span class="token string">'IP:MySQL Port'</span><span class="token punctuation">;</span> <span class="token comment">// 접속할 MySQL 서버의 IP와 Port(Default:3306)</span>
</span><span class="code-line"><span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span> <span class="token comment">// MySQL 유저 ID</span>
</span><span class="code-line"><span class="token keyword">var</span> userPwd <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span> <span class="token comment">// MySQL 유저 PW</span>
</span><span class="code-line"><span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span> <span class="token comment">// 접속할 MySQL DB명</span>
</span><span class="code-line"><span class="token keyword">var</span> instanceUrl <span class="token operator">=</span> <span class="token string">'jdbc:mysql://'</span> <span class="token operator">+</span> connectionName<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">var</span> dbUrl <span class="token operator">=</span> instanceUrl <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">+</span> db<span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">var</span> sheet <span class="token operator">=</span> <span class="token maybe-class-name">SpreadsheetApp</span><span class="token punctuation">.</span><span class="token method function property-access">getActiveSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// SpreadSheet 객체 생성</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">function</span> <span class="token function">exportDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">var</span> conn <span class="token operator">=</span> <span class="token maybe-class-name">Jdbc</span><span class="token punctuation">.</span><span class="token method function property-access">getConnection</span><span class="token punctuation">(</span>dbUrl<span class="token punctuation">,</span> user<span class="token punctuation">,</span> userPwd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// DB 연결</span>
</span><span class="code-line">  <span class="token keyword">var</span> stmt <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token method function property-access">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  stmt<span class="token punctuation">.</span><span class="token method function property-access">setMaxRows</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">var</span> results <span class="token operator">=</span> stmt<span class="token punctuation">.</span><span class="token method function property-access">executeQuery</span><span class="token punctuation">(</span><span class="token string">"SELECT title,content,author,date from eduboard"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 쿼리</span>
</span><span class="code-line">  <span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// 2번째 row부터 채움</span>
</span><span class="code-line">  <span class="token keyword control-flow">while</span><span class="token punctuation">(</span>results<span class="token punctuation">.</span><span class="token method function property-access">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">	  <span class="token comment">// getRange(Integer row, Integer Column)</span>
</span><span class="code-line">      title <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getRange</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// A2</span>
</span><span class="code-line">      content <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getRange</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// B2</span>
</span><span class="code-line">      author <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getRange</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// C2</span>
</span><span class="code-line">      date <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getRange</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// D2</span>
</span><span class="code-line">      title<span class="token punctuation">.</span><span class="token method function property-access">setValue</span><span class="token punctuation">(</span>results<span class="token punctuation">.</span><span class="token method function property-access">getString</span><span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 현재 row의 title 컬럼 값</span>
</span><span class="code-line">      content<span class="token punctuation">.</span><span class="token method function property-access">setValue</span><span class="token punctuation">(</span>results<span class="token punctuation">.</span><span class="token method function property-access">getString</span><span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 현재 row의 content 컬럼 값</span>
</span><span class="code-line">      author<span class="token punctuation">.</span><span class="token method function property-access">setValue</span><span class="token punctuation">(</span>results<span class="token punctuation">.</span><span class="token method function property-access">getString</span><span class="token punctuation">(</span><span class="token string">"author"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 현재 row의 author 컬럼 값</span>
</span><span class="code-line">      date<span class="token punctuation">.</span><span class="token method function property-access">setValue</span><span class="token punctuation">(</span>results<span class="token punctuation">.</span><span class="token method function property-access">getString</span><span class="token punctuation">(</span><span class="token string">"date"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 현재 row의 date 컬럼 값</span>
</span><span class="code-line">      i<span class="token operator">++</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">  
</span><span class="code-line">  <span class="token comment">/* 연결 해제 */</span>
</span><span class="code-line">  results<span class="token punctuation">.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  stmt<span class="token punctuation">.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  conn<span class="token punctuation">.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<h3 id="시트별-삽입">시트별 삽입</h3>
<p><img src="/assets/posts/mysql/yearlySheet.png" alt="">
시트가 이런식으로 나누어져있을 경우, 각 시트별로 데이터를 넣고싶다면 위 코드와 조금 다르게 해야한다.</p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token keyword">var</span> sheet <span class="token operator">=</span> <span class="token maybe-class-name">SpreadsheetApp</span><span class="token punctuation">.</span><span class="token method function property-access">getActiveSpreadsheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">var</span> activeSheet <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">function</span> <span class="token function">database_2019</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  activeSheet <span class="token operator">=</span> <span class="token string">"2019"</span><span class="token punctuation">;</span> <span class="token comment">// 시트명 변경</span>
</span><span class="code-line">  <span class="token maybe-class-name">SpreadsheetApp</span><span class="token punctuation">.</span><span class="token method function property-access">setActiveSheet</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span><span class="token method function property-access">getSheetByName</span><span class="token punctuation">(</span>activeSheet<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">var</span> conn <span class="token operator">=</span> <span class="token maybe-class-name">Jdbc</span><span class="token punctuation">.</span><span class="token method function property-access">getConnection</span><span class="token punctuation">(</span>dbUrl<span class="token punctuation">,</span> user<span class="token punctuation">,</span> userPwd<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// DB 연결</span>
</span><span class="code-line">  <span class="token keyword">var</span> stmt <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token method function property-access">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  stmt<span class="token punctuation">.</span><span class="token method function property-access">setMaxRows</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword">var</span> results <span class="token operator">=</span> stmt<span class="token punctuation">.</span><span class="token method function property-access">executeQuery</span><span class="token punctuation">(</span><span class="token string">"SELECT stuID,name,seminarTheme,seminarDate FROM seminar_list WHERE seminarDate BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY seminarDate DESC"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 특정 기간 내 데이터만 불러오는 쿼리</span>
</span><span class="code-line">  <span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token keyword control-flow">while</span><span class="token punctuation">(</span>results<span class="token punctuation">.</span><span class="token method function property-access">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    sID <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getRange</span><span class="token punctuation">(</span>activeSheet<span class="token operator">+</span><span class="token string">"!A"</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "시트명!A2" 특정 시트의 A2 위치에 삽입</span>
</span><span class="code-line">    sName <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getRange</span><span class="token punctuation">(</span>activeSheet<span class="token operator">+</span><span class="token string">"!B"</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// EX) test!A2:B2 일 경우 A2부터 B2까지 사각형 모양으로 채움</span>
</span><span class="code-line">    sTheme <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getRange</span><span class="token punctuation">(</span>activeSheet<span class="token operator">+</span><span class="token string">"!C"</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    sDate <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token method function property-access">getRange</span><span class="token punctuation">(</span>activeSheet<span class="token operator">+</span><span class="token string">"!D"</span><span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    sID<span class="token punctuation">.</span><span class="token method function property-access">setValue</span><span class="token punctuation">(</span>results<span class="token punctuation">.</span><span class="token method function property-access">getString</span><span class="token punctuation">(</span><span class="token string">"stuID"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    sName<span class="token punctuation">.</span><span class="token method function property-access">setValue</span><span class="token punctuation">(</span>results<span class="token punctuation">.</span><span class="token method function property-access">getString</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    sTheme<span class="token punctuation">.</span><span class="token method function property-access">setValue</span><span class="token punctuation">(</span>results<span class="token punctuation">.</span><span class="token method function property-access">getString</span><span class="token punctuation">(</span><span class="token string">"seminarTheme"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    sDate<span class="token punctuation">.</span><span class="token method function property-access">setValue</span><span class="token punctuation">(</span>results<span class="token punctuation">.</span><span class="token method function property-access">getString</span><span class="token punctuation">(</span><span class="token string">"seminarDate"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">    i<span class="token operator">++</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">  results<span class="token punctuation">.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  stmt<span class="token punctuation">.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  conn<span class="token punctuation">.</span><span class="token method function property-access">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span><span class="code-line">
</span></code></pre>
<ol>
<li>참고사이트1: <a href="https://developers.google.com/apps-script/guides/jdbc" target="_blank" rel="noopener noreferrer">Google Apps srcipt jdbc guide</a><br></li>
<li>참고사이트2: <a href="https://medium.com/@pradeepbheron/pull-and-sync-data-between-google-doc-spreadsheet-and-mysql-1d5a09d787a4" target="_blank" rel="noopener noreferrer">Blog</a><br></li>
</ol>
<p>위 코드는 ▶ 버튼을 눌러 실행시킬 수 있다.
<img src="/assets/posts/mysql/gs_script.png" alt=""></p>
<p>처음 실행시키면 권한 인증창이 뜨고 계정 선택 및 허용 등의 과정을 거치면 된다.
<img src="/assets/posts/mysql/run_popup.png" alt=""></p>
<p>실행 결과는 스프레드 시트에 바로 업데이트 된다.
<img src="/assets/posts/mysql/select_result.png" alt=""></p>
<p>실행 로그는 <code>보기>실행</code> 에서 확인해볼 수 있고, 실패 원인 분석 등에 쓰인다.
<img src="/assets/posts/mysql/run_log.png" alt=""></p></div></article></div></div></div><footer class="h-16 bg-neutral-500"></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"2019-04-15-MySQL-to-Googlespreadsheet","content":"\nMySQL 테이블 데이터를 구글 스프레드 시트로 만들어야 하는데 일일이 하긴 번거로워서\u003cbr\u003e\n구글 스프레드의 스크립트 기능을 이용해 커넥션을 생성, 데이터를 불러오는 코드를 짰다.\u003cbr\u003e\n이렇게 귀찮음을 코드로 푸는 나를 보면서 정말 컴공스럽다라는 생각이 든다....\u003cbr\u003e\n\n보안상의 이유로 실제 테이블 대신 블로그용 테스트 테이블을 사용했다. 테이블 구조는 다음과 같다.\n![](/assets/posts/mysql/eduboard.png)\n\n우선 외부에서 데이터베이스에 접속할 수 있도록 설정을 해주어야 한다.\n그 부분은 [이곳에서](https://idchowto.com/?p=11068)\n\n설정이 끝나면 구글 스프레드 시트를 하나 만들고 `도구 \u003e 스크립트 편집기`에 들어간다.\n![](/assets/posts/mysql/sheet_tools.png)\n\n```javascript\n\u003cscript src=\"https://gist.github.com/e6129c9fd9bc74e814d0?file-pull-and-sync-data-between-google-doc-spreadsheet-and-mysql-gs\" type=\"text/javascript\"/\u003e\nvar connectionName = 'IP:MySQL Port'; // 접속할 MySQL 서버의 IP와 Port(Default:3306)\nvar user = ''; // MySQL 유저 ID\nvar userPwd = ''; // MySQL 유저 PW\nvar db = ''; // 접속할 MySQL DB명\nvar instanceUrl = 'jdbc:mysql://' + connectionName;\nvar dbUrl = instanceUrl + '/' + db;\nvar sheet = SpreadsheetApp.getActiveSheet(); // SpreadSheet 객체 생성\n\nfunction exportDatabase() {\n  var conn = Jdbc.getConnection(dbUrl, user, userPwd); // DB 연결\n  var stmt = conn.createStatement();\n  stmt.setMaxRows(1000);\n  var results = stmt.executeQuery(\"SELECT title,content,author,date from eduboard\"); // 쿼리\n  var i=2; // 2번째 row부터 채움\n  while(results.next()) {\n\t  // getRange(Integer row, Integer Column)\n      title = sheet.getRange(i, 1); // A2\n      content = sheet.getRange(i, 2); // B2\n      author = sheet.getRange(i, 3); // C2\n      date = sheet.getRange(i, 4); // D2\n      title.setValue(results.getString(\"title\")); // 현재 row의 title 컬럼 값\n      content.setValue(results.getString(\"content\")); // 현재 row의 content 컬럼 값\n      author.setValue(results.getString(\"author\")); // 현재 row의 author 컬럼 값\n      date.setValue(results.getString(\"date\")); // 현재 row의 date 컬럼 값\n      i++;\n  }\n  \n  /* 연결 해제 */\n  results.close();\n  stmt.close();\n  conn.close();\n}\n```\n\n### 시트별 삽입\n![](/assets/posts/mysql/yearlySheet.png)\n시트가 이런식으로 나누어져있을 경우, 각 시트별로 데이터를 넣고싶다면 위 코드와 조금 다르게 해야한다.\n```javascript\nvar sheet = SpreadsheetApp.getActiveSpreadsheet();\nvar activeSheet = '';\n\nfunction database_2019() {\n  activeSheet = \"2019\"; // 시트명 변경\n  SpreadsheetApp.setActiveSheet(sheet.getSheetByName(activeSheet));\n  var conn = Jdbc.getConnection(dbUrl, user, userPwd); // DB 연결\n  var stmt = conn.createStatement();\n  stmt.setMaxRows(1000);\n  var results = stmt.executeQuery(\"SELECT stuID,name,seminarTheme,seminarDate FROM seminar_list WHERE seminarDate BETWEEN '2019-01-01' AND '2019-12-31' ORDER BY seminarDate DESC\"); // 특정 기간 내 데이터만 불러오는 쿼리\n  var i=2;\n  while(results.next()) {\n    sID = sheet.getRange(activeSheet+\"!A\"+i); // \"시트명!A2\" 특정 시트의 A2 위치에 삽입\n    sName = sheet.getRange(activeSheet+\"!B\"+i); // EX) test!A2:B2 일 경우 A2부터 B2까지 사각형 모양으로 채움\n    sTheme = sheet.getRange(activeSheet+\"!C\"+i);\n    sDate = sheet.getRange(activeSheet+\"!D\"+i);\n    sID.setValue(results.getString(\"stuID\"));\n    sName.setValue(results.getString(\"name\"));\n    sTheme.setValue(results.getString(\"seminarTheme\"));\n    sDate.setValue(results.getString(\"seminarDate\"));\n    i++;\n  }\n  results.close();\n  stmt.close();\n  conn.close();\n}\n\n```\n\n\n\n1. 참고사이트1: [Google Apps srcipt jdbc guide](https://developers.google.com/apps-script/guides/jdbc)\u003cbr\u003e\n2. 참고사이트2: [Blog](https://medium.com/@pradeepbheron/pull-and-sync-data-between-google-doc-spreadsheet-and-mysql-1d5a09d787a4)\u003cbr\u003e\n\n위 코드는 ▶ 버튼을 눌러 실행시킬 수 있다.\n![](/assets/posts/mysql/gs_script.png)\n\n처음 실행시키면 권한 인증창이 뜨고 계정 선택 및 허용 등의 과정을 거치면 된다.\n![](/assets/posts/mysql/run_popup.png)\n\n실행 결과는 스프레드 시트에 바로 업데이트 된다.\n![](/assets/posts/mysql/select_result.png)\n\n실행 로그는 `보기\u003e실행` 에서 확인해볼 수 있고, 실패 원인 분석 등에 쓰인다.\n![](/assets/posts/mysql/run_log.png)\n","layout":"post","title":"[MySQL] MySQL 데이터를 구글 스프레드 시트로 불러오기","categories":["MySQL"],"excerpt":" ","comments":true,"share":true,"tags":["MySQL","Google"]}},"__N_SSG":true},"page":"/articles/[dir_slug]/[slug]","query":{"dir_slug":"2019-04","slug":"MySQL-to-Googlespreadsheet"},"buildId":"nJPyYqODS0udXw2rMLLyn","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>