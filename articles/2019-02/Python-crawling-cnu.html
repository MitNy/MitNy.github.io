<!DOCTYPE html><html><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-W055DP4N3J"></script><script>
					window.dataLayer = window.dataLayer || [];
					function gtag(){dataLayer.push(arguments);}
					gtag('js', new Date());
					gtag('config', 'G-W055DP4N3J');</script><head><meta charSet="utf-8"/><meta name="description" content="기록 저장소"/><meta property="og:description" content="기록 저장소"/><meta property="og:url" content="https://mitny.github.io"/><meta property="og:type" content="website"/><meta property="og:locale" content="ko_KR"/><meta property="og:site_name" content="MitNy.log"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><title>[Python] 학과 홈페이지 크롤링 |  MitNy.log</title><meta name="robots" content="index,follow"/><meta property="og:title" content="[Python] 학과 홈페이지 크롤링 |  MitNy.log"/><link rel="canonical" href="https://mitny.github.io/articles/2019-02-26-Python-crawling-cnu"/><meta name="next-head-count" content="12"/><meta name="naver-site-verification" content="b408dee953bcbbb1038384f191f36dac0551c0fb"/><meta name="google-site-verification" content="vUtYhRYNCWYYTdurCRaVmtnWpPLuXKKwRAm5F6R9sNs"/><link rel="preload" href="/_next/static/css/e6a7c67d207b98b3.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e6a7c67d207b98b3.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-005bdf76005efab4.js" defer=""></script><script src="/_next/static/chunks/pages/_app-14a2a9a26060c1d3.js" defer=""></script><script src="/_next/static/chunks/401-9f1400d964d6d7ce.js" defer=""></script><script src="/_next/static/chunks/pages/articles/%5Bdir_slug%5D/%5Bslug%5D-0b7b92862b8a360a.js" defer=""></script><script src="/_next/static/nJPyYqODS0udXw2rMLLyn/_buildManifest.js" defer=""></script><script src="/_next/static/nJPyYqODS0udXw2rMLLyn/_ssgManifest.js" defer=""></script></head><link rel="apple-touch-icon" sizes="57x57" href="/favicon/apple-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/favicon/apple-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/favicon/apple-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/favicon/apple-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/favicon/apple-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/favicon/apple-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/favicon/apple-icon-152x152.png"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-icon-180x180.png"/><link rel="icon" type="image/png" sizes="192x192" href="/favicon/android-icon-192x192.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="96x96" href="/favicon/favicon-96x96.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"/><link rel="manifest" href="/favicon/manifest.json"/><meta name="msapplication-TileColor" content="#ffffff"/><meta name="msapplication-TileImage" content="/favicon/ms-icon-144x144.png"/><meta name="theme-color" content="#ffffff"/><body><div id="__next" data-reactroot=""><div class="header h-16 bg-white drop-shadow-md text-black"><div class="mx-10 pt-3 cursor-pointer"><p class="header-home text-3xl float-left">MitNy.log</p><p class="text-base font-bold pt-2 float-right">About</p></div></div><div class="mx-10 my-8"><div class="w-full min-h-screen pb-24 mt-8"><div class="w-full min-h-screen pb-24 mt-8"><article class="prose max-w-none"><div class="border-b"><p class="text-4xl font-bold mb-0">[Python] 학과 홈페이지 크롤링</p><p class="text-xs text-neutral-500"></p></div><div><p>학과 홈페이지에 좋은 정보가 게시되는데 항상 학과 홈페이지에 접속하긴 번거로워서 알림 앱을 만들기 위한
데이터 수집 및 저장용 크롤러를 제작하였다.</p>
<h4 id="target">Target</h4>
<p>충남대학교 컴퓨터융합학부(前 컴퓨터공학과) 공지사항 > 취업정보</p>
<h4 id="used">Used</h4>
<ul>
<li>Python 3.5.2</li>
<li>BeautifulSoup module</li>
<li>Firebase</li>
</ul>
<p>취업정보 게시판에 올라오는 글들
<img src="/assets/posts/python/posting_data.png" alt=""></p>
<pre class="language-py"><code class="language-py code-highlight"><span class="code-line"><span class="token keyword">import</span> requests
</span><span class="code-line"><span class="token keyword">import</span> re
</span><span class="code-line"><span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup
</span><span class="code-line"><span class="token keyword">import</span> datetime
</span><span class="code-line"><span class="token keyword">from</span> firebase <span class="token keyword">import</span> firebase
</span><span class="code-line"><span class="token keyword">import</span> threading
</span><span class="code-line">
</span><span class="code-line">firebase <span class="token operator">=</span> firebase<span class="token punctuation">.</span>FirebaseApplication<span class="token punctuation">(</span><span class="token string">'https://***.firebaseio.com/'</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">get_job_post</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] parser is running...\n"</span><span class="token punctuation">)</span>
</span><span class="code-line">	url <span class="token operator">=</span> <span class="token string">"http://computer.cnu.ac.kr/index.php?mid=job"</span>
</span><span class="code-line">	request <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	html <span class="token operator">=</span> request<span class="token punctuation">.</span>text
</span><span class="code-line">	soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>html<span class="token punctuation">,</span><span class="token string">"html.parser"</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	table <span class="token operator">=</span> soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"tbody"</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment">#title_data = []</span>
</span><span class="code-line">	<span class="token comment">#time_data = []</span>
</span><span class="code-line">	<span class="token comment"># 타이틀만 가져옴</span>
</span><span class="code-line">	<span class="token comment">#for t in table.find_all("a"):</span>
</span><span class="code-line">	<span class="token comment">#	text_data = t.get_text().replace("\t","")</span>
</span><span class="code-line">	<span class="token comment">#	for i in text_data.split("\n"):</span>
</span><span class="code-line">	<span class="token comment">#		if i is not "":</span>
</span><span class="code-line">	<span class="token comment">#			title_data.append(i)</span>
</span><span class="code-line">	
</span><span class="code-line">	<span class="token comment"># 시간만 가져옴</span>
</span><span class="code-line">	<span class="token comment">#for t in table.find_all("td",["time"]):</span>
</span><span class="code-line">	<span class="token comment">#	text_data = t.get_text()</span>
</span><span class="code-line">	<span class="token comment">#	for i in text_data.split("\n"):</span>
</span><span class="code-line">	<span class="token comment">#		if i is not "":</span>
</span><span class="code-line">	<span class="token comment">#			time_data.append(i)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment"># time/title 태그 파싱</span>
</span><span class="code-line">	parse_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line">	<span class="token keyword">for</span> t <span class="token keyword">in</span> table<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"td"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">,</span><span class="token string">"time"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">		text_data <span class="token operator">=</span> t<span class="token punctuation">.</span>get_text<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\t"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token keyword">for</span> i <span class="token keyword">in</span> text_data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">			<span class="token keyword">if</span> i <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token string">""</span><span class="token punctuation">:</span>
</span><span class="code-line">				parse_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token comment"># time/title key 딕셔너리 생성 후 리스트에 넣음</span>
</span><span class="code-line">	result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
</span><span class="code-line">	dic_data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>parse_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">		regex <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r"([12]\d{3}.(0[1-9]|1[0-2]).(0[1-9]|[12]\d|3[01]))"</span><span class="token punctuation">)</span> <span class="token comment"># YYYY.mm.dd 포맷 정규식</span>
</span><span class="code-line">		m <span class="token operator">=</span> regex<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span>parse_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token keyword">if</span> m<span class="token punctuation">:</span> <span class="token comment"># 날짜 포맷과 일치할 경우 time(key)에 value 저장</span>
</span><span class="code-line">			dic_data<span class="token punctuation">[</span><span class="token string">"time"</span><span class="token punctuation">]</span> <span class="token operator">=</span> m<span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">		<span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment"># 일치하지 않을 경우title(key)에 value 저장</span>
</span><span class="code-line">			dic_data<span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">]</span> <span class="token operator">=</span> parse_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
</span><span class="code-line">
</span><span class="code-line">		<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>dic_data<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token comment"># time/title 딕셔너리가 완성되면 result에 저장 후 딕셔너리 초기화</span>
</span><span class="code-line">			result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>dic_data<span class="token punctuation">)</span>
</span><span class="code-line">			dic_data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</span><span class="code-line">
</span><span class="code-line">	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># Firebase database에 저장</span>
</span><span class="code-line">		<span class="token keyword">try</span><span class="token punctuation">:</span>
</span><span class="code-line">			firebase<span class="token punctuation">.</span>patch<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>result<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> 
</span><span class="code-line">		<span class="token keyword">except</span><span class="token punctuation">:</span>
</span><span class="code-line">			<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[-] Update Error\n"</span><span class="token punctuation">)</span>
</span><span class="code-line">	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] Update completed\n"</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line">	threading<span class="token punctuation">.</span>Timer<span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span>get_job_post<span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 10분마다 반복</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
</span><span class="code-line">	get_job_post<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
</span><span class="code-line">	main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></code></pre>
<p>Firebase database에 잘 저장되고 있다 :)
<img src="/assets/posts/python/parsing_data.png" alt=""></p></div></article></div></div></div><footer class="h-16 bg-neutral-500"></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"2019-02-26-Python-crawling-cnu","content":"\n학과 홈페이지에 좋은 정보가 게시되는데 항상 학과 홈페이지에 접속하긴 번거로워서 알림 앱을 만들기 위한\n데이터 수집 및 저장용 크롤러를 제작하였다.\n\n#### Target\n충남대학교 컴퓨터융합학부(前 컴퓨터공학과) 공지사항 \u003e 취업정보\n\n#### Used\n- Python 3.5.2\n- BeautifulSoup module\n- Firebase\n\n취업정보 게시판에 올라오는 글들\n![](/assets/posts/python/posting_data.png)\n\n```py\nimport requests\nimport re\nfrom bs4 import BeautifulSoup\nimport datetime\nfrom firebase import firebase\nimport threading\n\nfirebase = firebase.FirebaseApplication('https://***.firebaseio.com/', None)\n\ndef get_job_post():\n\tprint(\"[+] parser is running...\\n\")\n\turl = \"http://computer.cnu.ac.kr/index.php?mid=job\"\n\trequest = requests.get(url)\n\n\thtml = request.text\n\tsoup = BeautifulSoup(html,\"html.parser\")\n\n\ttable = soup.find(\"tbody\")\n\n\t#title_data = []\n\t#time_data = []\n\t# 타이틀만 가져옴\n\t#for t in table.find_all(\"a\"):\n\t#\ttext_data = t.get_text().replace(\"\\t\",\"\")\n\t#\tfor i in text_data.split(\"\\n\"):\n\t#\t\tif i is not \"\":\n\t#\t\t\ttitle_data.append(i)\n\t\n\t# 시간만 가져옴\n\t#for t in table.find_all(\"td\",[\"time\"]):\n\t#\ttext_data = t.get_text()\n\t#\tfor i in text_data.split(\"\\n\"):\n\t#\t\tif i is not \"\":\n\t#\t\t\ttime_data.append(i)\n\n\t# time/title 태그 파싱\n\tparse_data = []\n\tfor t in table.find_all(\"td\",[\"title\",\"time\"]):\n\t\ttext_data = t.get_text().replace(\"\\t\",\"\")\n\t\tfor i in text_data.split(\"\\n\"):\n\t\t\tif i is not \"\":\n\t\t\t\tparse_data.append(i)\n\n\t# time/title key 딕셔너리 생성 후 리스트에 넣음\n\tresult = []\n\tdic_data = {}\n\tfor i in range(0,len(parse_data)):\n\t\tregex = re.compile(r\"([12]\\d{3}.(0[1-9]|1[0-2]).(0[1-9]|[12]\\d|3[01]))\") # YYYY.mm.dd 포맷 정규식\n\t\tm = regex.match(parse_data[i])\n\t\tif m: # 날짜 포맷과 일치할 경우 time(key)에 value 저장\n\t\t\tdic_data[\"time\"] = m.group()\n\t\telse: # 일치하지 않을 경우title(key)에 value 저장\n\t\t\tdic_data[\"title\"] = parse_data[i]\n\n\t\tif len(dic_data) == 2: # time/title 딕셔너리가 완성되면 result에 저장 후 딕셔너리 초기화\n\t\t\tresult.append(dic_data)\n\t\t\tdic_data = {}\n\n\tfor i in range(0,len(result)): # Firebase database에 저장\n\t\ttry:\n\t\t\tfirebase.patch(\"/\"+str(i),result[i]) \n\t\texcept:\n\t\t\tprint(\"[-] Update Error\\n\")\n\tprint(\"[+] Update completed\\n\")\n\n\tthreading.Timer(600,get_job_post).start() # 10분마다 반복\n\ndef main():\n\tget_job_post()\n\nif __name__ == \"__main__\":\n\tmain()\n```\n\n\nFirebase database에 잘 저장되고 있다 :)\n![](/assets/posts/python/parsing_data.png)\n","layout":"post","title":"[Python] 학과 홈페이지 크롤링","categories":["Python"],"excerpt":" ","comments":true,"share":true,"tags":["Python","BeautifulSoup","crawling"]}},"__N_SSG":true},"page":"/articles/[dir_slug]/[slug]","query":{"dir_slug":"2019-02","slug":"Python-crawling-cnu"},"buildId":"nJPyYqODS0udXw2rMLLyn","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>