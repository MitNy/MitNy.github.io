{"pageProps":{"post":{"slug":"2018-10-02-CTF-misc","content":"\n제가 처음 CTF에 참여했을 때도 지금도 CTF 문제 목록에서 1~2순위로 보게 되는 분야가 MISC입니다.\n리버싱, 포너블 등의 문제보다는 진입 장벽이 낮고 센스를 요구하는 문제들이 많기 때문이라고 생각됩니다.\n정말 재미있는 문제도 있는가 하면 너무너무 게싱이 심한 경우도 있어서 난이도는 타분야와 마찬가지로 천차만별인 것 같아요.\n그래서 저는 이번 포스팅에서 MISC에 대한 간단한 설명과 몇 가지 문제를 풀어보도록 하겠습니다.\nver.1 이니까 다음도 있겠죠...???\n\n`MISC`는 Miscellaneous(여러 가지 종류의,잡다한) 의 약어이고 CTF에서는 '기타' 문제에 해당됩니다.\n\n<br>\n# [TJCTF 2018] Moar Horses\n 문제 링크 : [https://moar_horse.tjctf.org/](https://moar_horse.tjctf.org/)\n\n![](/assets/posts/ctf/TJ2018/tjctf_horse.png)\n\nMoar Horses 문제 페이지에 들어가면 말이 있고, 스크롤을 내리면 계속 다리가 늘어난다.\n\n```html\n<div id=\"horse\" class=\"centered\" style=\"padding-top: 222px\">\n    <h1>Scroll down to find the flag!</h1>\n        <pre>   ,\n_,,)\\.~,,._\n(()`  ``)\\))),,_\n |     \\ ''((\\)))),,_          ____\n |6`   |   ''((\\())) \"-.____.-\"    `-.-,\n |    .'\\    ''))))'                  \\)))\n |   |   `.     ''                     ((((\n \\, _)     \\/                          |))))\n  `'        |                          (((((\n            \\                  |       ))))))\n             `|    |           ,\\     /((((((\n              |   / `-.______.&lt;  \\   |  )))))\n              |   |  /         `. \\  \\  ((((\n              |  / \\ |           `.\\  | (((\n              \\  | | |             )| |  ))\n               | | | |             || |  '</pre>\n<a href=\"/legs\"></a>\n```\n\n코드를 보면 맨 아래 /legs로 이동하는 링크가 있다. 그냥 페이지에선 아무리 내려도 보이지 않는다.\n\n![](/assets/posts/ctf/TJ2018/tjctf_leg.png)\n\n`Oops, you couldn't get the flag` 를 눌러도 `<a href=\"/legs\">` 태그이기 때문에 계속 같은 페이지가 로드된다.\n\n파이썬 requests를 이용해서 `Oops, you couldn't get the flag` 가 뜨지 않는 경우를 찾을 것이다.\n\n```py\nimport requests\n\nurl = \"https://moar_horse.tjctf.org/legs\"\n\nwhile True:\n        result = requests.get(url).text\n        if \"Oops\" not in result:\n                print(result)\n                break\n```\n\n![](/assets/posts/ctf/TJ2018/tjctf_flag.png)\n\n결과가 나오는 데는 좀 걸린다. 조건을 `if \"tjctf\" in result` 로 주었을 땐 더 오래 걸리는 느낌이다..\n\n`tjctf{h0rs3s_h4v3_lonG_l3gS}`\n\n재미있는 문제였다 :)\n\n<br><br>\n# [SharifCTF 8] The Skeleton Key\n\n문제 파일 : [http://ctf-writeups.ru/wp-content/uploads/2018/02/the-skeleton-key.zip](http://ctf-writeups.ru/wp-content/uploads/2018/02/the-skeleton-key.zip)\n\n![](/assets/posts/ctf/Sharif8/skeleton_apk.png)\n\n다운로드 받은 파일의 압축을 해제하면 apk 파일이 보인다. \n\n![](/assets/posts/ctf/Sharif8/skeleton_svg.png)\n\napk를 zip으로 바꿔서 보면 파일의 내부를 볼 수 있고, assets 폴더에 logo.svg가 있었다.\n\n![](/assets/posts/ctf/Sharif8/skeleton_logo.png)\n\nlogo.svg를 열면 해골이 보인다. \nsvg 파일을 편집하기 위해 Inkspace를 사용했다. 일러스트레이터도 있지만 깔기가 귀찮았다..ㅎㅎ\n\n![](/assets/posts/ctf/Sharif8/skeleton_dot.png)\n\n해골의 눈 코,입을 분해하다보니 광대 밑쪽에 작은 점이 보였다.\n이 부분을 돋보기 기능으로 쭉 확대하면 플래그가 있다!\n\n![](/assets/posts/ctf/Sharif8/skeleton_flag.png)\n<br><br>\n# [DefCamp CTF Qualification 2018] Message\n\nmessage.txt 파일이 주어지고 꽤 긴 문자열이지만 반복되는 단어들이 보인다.\n\nCTF인 만큼 눈에 띄는 문자열은 `{zxcvbnrfvbhgzxcvbn6zxcvbn6asdfghedcvrfzxcvbnredcvasdfghzsefvcxasdfghxcvbgrdasdfghgrdxcvbzxcvbn9qwerty0zxcvbnzsefvcxzxcvbnedcvgrasdfgh0asdfgh5qwertyyhnmkuasdfghredcfasdfgh5zxcvbnwsxcfeqwertyzsefvcxasdfghwsxcfdqwerty3qwerty3qwertyedcvgrqwerty7zxcvbn1qwertygrdxcvbqwerty8asdfghtrfvgzxcvbn7zxcvbn0qwerty9qwerty3qwerty4zxcvbn4zxcvbn0qwerty8zxcvbnredcfzxcvbn3zxcvbnzsefvcxzxcvbn5zxcvbn8qwerty4asdfgh7qwertyzsefvcxasdfgh4asdfghewsxczxcvbn5zxcvbntrfvbzxcvbn3asdfgh8zxcvbnedcvgrqwertyqazxdsasdfgh7zxcvbn5qwerty8asdfgh9asdfgh1qwertyrfvbhgasdfgh0zxcvbntrfvgasdfgh0qwertywsxcdezxcvbn3qwerty2zxcvbn}` 이다.\n\n숫자가 중간중간 끼어 있으므로 이 문자열을 숫자 기준으로 나눠서 정리해보려고 한다.\n```\nzxcvbnrfvbhgzxcvbn zxcvbn asdfghedcvrfzxcvbnredcvasdfghzsefvcxasdfghxcvbgrdasdfghgrdxcvbzxcvbn qwerty zxcvbnzsefvcxzxcvbnedcvgrasdfgh asdfgh qwertyyhnmkuasdfghredcfasdfgh zxcvbnwsxcfeqwertyzsefvcxasdfghwsxcfdqwerty qwerty qwertyedcvgrqwerty zxcvbn qwertygrdxcvbqwerty asdfghtrfvgzxcvbn zxcvbn qwerty qwerty qwerty zxcvbn zxcvbn qwerty zxcvbnredcfzxcvbn zxcvbnzsefvcxzxcvbn zxcvbn qwerty asdfgh qwertyzsefvcxasdfghasdfghewsxczxcvbn zxcvbntrfvbzxcvbn asdfgh zxcvbnedcvgrqwertyqazxdsasdfgh zxcvbn qwerty asdfgh asdfgh qwertyrfvbhgasdfgh zxcvbntrfvgasdfgh qwertywsxcdezxcvbn qwerty zxcvbn\n```\n\n반복되는 문자열들을 보면 다음과 같다. 이런 결과는 키보드 위에 아래 문자열들을 그려보면 알 수 있다.\n1. wsxcv -> L\n2. rfvbnhyt -> O\n3. mnbvcdrtghu -> R\n4. wsxcde -> \n5. zaqwdrtgb -> M\n6. wsx -> I\n7. nbvcxswefr -> \n8. iuyhnbv -> S\n9. wsxcvfr -> U\n10. zaqwdrtgb -> M\n11. asdfgh, qwerty, zxcvbn -> \" \"\n\n\n![](/assets/posts/ctf/defcamp2018/message_k1.png)\n\n![](/assets/posts/ctf/defcamp2018/message_k2.png)\n\n\nLOR M I SUM 의 빈 칸은 `LOREM IPSUM(로렘 입숨)` 라는 단어로 완성된다.\n\n![](/assets/posts/ctf/defcamp2018/loremipsum.png)\n\n```java\npublic class replace {\n\tpublic static void main(String[] args) {\n\t\tString s = \"zxcvbnrfvbhgzxcvbn6zxcvbn6asdfghedcvrfzxcvbnredcvasdfghzsefvcxasdfghxcvbgrdasdfghgrdxcvbzxcvbn9qwerty0zxcvbnzsefvcxzxcvbnedcvgrasdfgh0asdfgh5qwertyyhnmkuasdfghredcfasdfgh5zxcvbnwsxcfeqwertyzsefvcxasdfghwsxcfdqwerty3qwerty3qwertyedcvgrqwerty7zxcvbn1qwertygrdxcvbqwerty8asdfghtrfvgzxcvbn7zxcvbn0qwerty9qwerty3qwerty4zxcvbn4zxcvbn0qwerty8zxcvbnredcfzxcvbn3zxcvbnzsefvcxzxcvbn5zxcvbn8qwerty4asdfgh7qwertyzsefvcxasdfgh4asdfghewsxczxcvbn5zxcvbntrfvbzxcvbn3asdfgh8zxcvbnedcvgrqwertyqazxdsasdfgh7zxcvbn5qwerty8asdfgh9asdfgh1qwertyrfvbhgasdfgh0zxcvbntrfvgasdfgh0qwertywsxcdezxcvbn3qwerty2zxcvbn\";\n\t\t\n\t\tString replace = s.replaceAll(\"mnbvcdrtghu\",\"R\");\n\t\treplace = replace.replaceAll(\"efvgywdcft\",\"W\");\n\t\treplace = replace.replaceAll(\"nbvcxswefr\",\"P\");\n\t\treplace = replace.replaceAll(\"mnbvccdertg\",\"P\");\n\t\treplace = replace.replaceAll(\"nbvcxswerf\",\"P\");\n\t\treplace = replace.replaceAll(\"zaqwdrtgb\",\"M\");\n\t\treplace = replace.replaceAll(\"xsweftynh\",\"M\");\n\t\treplace = replace.replaceAll(\"xsweftyhn\",\"M\");\n\t\treplace = replace.replaceAll(\"xsweftgb\",\"N\");\n\t\treplace = replace.replaceAll(\"zaqwdvfr\",\"N\");\n\t\treplace = replace.replaceAll(\"xsweftbg\",\"N\");\n\t\treplace = replace.replaceAll(\"rfvbnhyt\",\"O\");\n\t\treplace = replace.replaceAll(\"qazxcdew\",\"O\");\n\t\treplace = replace.replaceAll(\"wsxcvfre\",\"O\");\n\t\treplace = replace.replaceAll(\"rfvgyhn\",\"H\");\n\t\treplace = replace.replaceAll(\"edcftgb\",\"H\");\n\t\treplace = replace.replaceAll(\"wsxdrfv\",\"H\");\n\t\treplace = replace.replaceAll(\"iuyhnbv\",\"S\");\n\t\treplace = replace.replaceAll(\"ytrfvcx\",\"S\");\n\t\treplace = replace.replaceAll(\"rtyuihn\",\"T\");\n\t\treplace = replace.replaceAll(\"wertyfv\",\"T\");\n\t\treplace = replace.replaceAll(\"wsxcvfr\",\"U\");\n\t\treplace = replace.replaceAll(\"edcvbgt\",\"U\");\n\t\treplace = replace.replaceAll(\"grdxcvb\",\"A\");\n\t\treplace = replace.replaceAll(\"zsefvcx\",\"A\");\n\t\treplace = replace.replaceAll(\"xcvbgrd\",\"A\");\n\t\treplace = replace.replaceAll(\"qazxds\",\"B\");\n\t\treplace = replace.replaceAll(\"wsxcfd\",\"B\");\n\t\treplace = replace.replaceAll(\"rfvbhg\",\"B\");\n\t\treplace = replace.replaceAll(\"ewsxc\",\"C\");\n\t\treplace = replace.replaceAll(\"redcv\",\"C\");\n\t\treplace = replace.replaceAll(\"trfvb\",\"C\");\n\t\treplace = replace.replaceAll(\"edcvgr\",\"D\");\n\t\treplace = replace.replaceAll(\"yhnmku\",\"D\");\n\t\treplace = replace.replaceAll(\"wsxcfe\",\"D\");\n\t\treplace = replace.replaceAll(\"wsxcde\",\"E\");\n\t\treplace = replace.replaceAll(\"edcvrf\",\"E\");\n\t\treplace = replace.replaceAll(\"tgbnhy\",\"E\");\n\t\treplace = replace.replaceAll(\"trfvg\",\"F\");\n\t\treplace = replace.replaceAll(\"redcf\",\"F\");\n\t\treplace = replace.replaceAll(\"ewsxd\",\"F\");\n\t\treplace = replace.replaceAll(\"cvgred\",\"G\");\n\t\treplace = replace.replaceAll(\"cvrged\",\"G\");\n\t\treplace = replace.replaceAll(\"redcvg\",\"G\");\n\t\treplace = replace.replaceAll(\"edcfby\",\"K\");\n\t\treplace = replace.replaceAll(\"qazsce\",\"K\");\n\t\treplace = replace.replaceAll(\"edcfby\",\"K\");\n\t\treplace = replace.replaceAll(\"rgnygc\",\"X\");\n\t\treplace = replace.replaceAll(\"wdvtdz\",\"X\");\n\t\treplace = replace.replaceAll(\"wsxcv\",\"L\");\n\t\treplace = replace.replaceAll(\"edcvb\",\"L\");\n\t\treplace = replace.replaceAll(\"rfvbn\",\"L\");\n\t\treplace = replace.replaceAll(\"wdcft\",\"V\");\n\t\treplace = replace.replaceAll(\"efvgy\",\"V\");\n\t\treplace = replace.replaceAll(\"efvt\", \"Y\");\n\t\treplace = replace.replaceAll(\"jmyi\",\"Y\");\n\t\treplace = replace.replaceAll(\"wsx\",\"I\");\n\t\treplace = replace.replaceAll(\"edc\",\"I\");\n\t\treplace = replace.replaceAll(\"rfv\",\"I\");\n\t\treplace = replace.replaceAll(\"qwerty\",\"\");\n\t\treplace = replace.replaceAll(\"asdfgh\",\"\");\n\t\treplace = replace.replaceAll(\"zxcvbn\",\"\");\n\t\t\t\n\t\tSystem.out.println(replace);\n\t}\n}\n```\n\n노가다의 산물...\n\n![](/assets/posts/ctf/defcamp2018/message_result.png)\n\n`DCTF{B66ECAAA90AD05DF5DAB33D71A8F70934408F3A5847A4C5C38DB75891B0F0E32}`\n","layout":"post","title":"[CTF] MISC 모음 ver.1","categories":["CTF"],"excerpt":" ","comments":true,"share":true,"tags":["ctf","MISC","write-up","MitNy"]}},"__N_SSG":true}