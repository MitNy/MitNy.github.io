{"pageProps":{"post":{"slug":"2017-10-12-pwnable-random","content":"\npasscode 문제를 풀다가 잘 안돼서 다른 문제로 넘어왔다ㅎㅎ\n알고보니 passcode 문제는 무려 10point 짜리 문제였다! 순서대로 푸는 건줄 알았는데...\n아직 시스템 초보이므로 point가 낮은 것부터 차근차근 풀기로 했다.\n그래서 고른 문제가 random\n\n![](/assets/posts/pwnkr/random.png)\n\nrandom.c 의 코드는 다음과 같다.\n```c\n#include <stdio.h>\n\n\n\nint main(){\n\tunsigned int random;\n\trandom = rand();\t// random value!\n\tunsigned int key=0;\n\tscanf(\"%d\", &key);\n\n\tif( (key ^ random) == 0xdeadbeef ){\n\t\tprintf(\"Good!\\n\");\n\t\tsystem(\"/bin/cat flag\");\n\t\treturn 0;\n\t}\n\tprintf(\"Wrong, maybe you should try 2^32 cases.\\n\");\n\treturn 0;\n}\n```\n\nrand() 함수로 random value를 random 변수에 저장한다.\nkey는 0으로 초기화 되어있고, key를 입력받는다.\nkey와 random 을 XOR 했을 때, 0xdeadbeef와 일치하면 flag를 출력해준다.\n어떻게 어떤 값이 나올지 모르는 random value와 사용자 입력 key를 XOR 해서 deadbeef를 만들까?\n\n0xdeadbeef ^ x 는 일정한 값이고,  계산된 값을 다시 x로 XOR하면 0xdeadbeef가 나오게 된다.\n\n예를 들어,\n0xdeadbeef ^ 1234 = 0xdeadacd8 이고\n0xdeadacd8 ^ 1234 = deadbeef 이다.\n\n찾아보니, 같은 seed 에선 생성되는 random value도 같다고 한다.\n그렇다면 항상 같은 random value와 0xdeadbeef를 XOR 시킨 값을 다시 random value와 XOR 시키면 되기 때문에,\n코드를 짜서 key값을 출력하도록 하고, 출력된 키 값을 random을 실행시킨 후 입력하면 될 것 같다.\n\n![](/assets/posts/pwnkr/random_code.png)\n\n이런식으로 rand() 함수로 random value를 생성하고, 0xdeadbeef와 XOR 한 값을 key에 저장한다.\n\n![](/assets/posts/pwnkr/random_key.png)\n\n`key = 3039230856`\n이 숫자를 입력해주면 된다.\n\n![](/assets/posts/pwnkr/random_clear.png)\n","layout":"post","title":"[Pwnable.kr] random","categories":["Pwnable.kr"],"excerpt":" ","comments":true,"share":true,"tags":["Pwnable.kr","random"]}},"__N_SSG":true}