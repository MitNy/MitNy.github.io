{"pageProps":{"post":{"slug":"2019-07-04-LOS-nightmare","content":"\n`query : select id from prob_nightmare where pw=('') and id!='admin'`\n\n```php\n<?php \n  include \"./config.php\"; \n  login_chk(); \n  $db = dbconnect(); \n  if(preg_match('/prob|_|\\.|\\(\\)|#|-/i', $_GET[pw])) exit(\"No Hack ~_~\"); \n  if(strlen($_GET[pw])>6) exit(\"No Hack ~_~\"); \n  $query = \"select id from prob_nightmare where pw=('{$_GET[pw]}') and id!='admin'\"; \n  echo \"<hr>query : <strong>{$query}</strong><hr><br>\"; \n  $result = @mysqli_fetch_array(mysqli_query($db,$query)); \n  if($result['id']) solve(\"nightmare\"); \n  highlight_file(__FILE__); \n?>\n```\n\npw 부분이 괄호가 쳐져있고 pw의 길이도 6이 넘으면 안된다.\n`#,-`과 같은 주석 처리도 필터링되므로 괄호를 이용해 문제를 풀어야할 것 같다.\n\nmysql에서 ''과 일치하는 것은 0이므로 `')=0;%00`와 같이 참 조건을 만들어주고\n`and id!=admin` 부분을 생략하도록 세미콜론과 null 문자를 넣어줌으로써 풀 수 있다.\n\n![](/assets/posts/los/nightmare_clear.png)\n\n클리어!!\n","layout":"post","title":"[LOS] nightmare","categories":["LOS"],"excerpt":" ","comments":true,"share":true,"tags":["Web-hacking","LOS","write-up"]}},"__N_SSG":true}