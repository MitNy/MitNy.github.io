{"pageProps":{"post":{"slug":"2017-07-30-Wargamekr-login-filtering","content":"![](/assets/posts/wargamekr/wargamekr.png)\n\n![](/assets/posts/wargamekr/login-filtering-main.png)\n\n로그인 필터링 문제의 소스를 보면\n```php\n<?php\n\n\nif (isset($_GET['view-source'])) {\n    show_source(__FILE__);\n    exit();\n}\n\n/*\ncreate table user(\n idx int auto_increment primary key,\n id char(32),\n ps char(32)\n);\n*/\n\n if(isset($_POST['id']) && isset($_POST['ps'])){\n  include(\"../lib.php\"); # include for auth_code function.\n\n  mysql_connect(\"localhost\",\"login_filtering\",\"login_filtering_pz\");\n  mysql_select_db (\"login_filtering\");\n  mysql_query(\"set names utf8\");\n\n  $key = auth_code(\"login filtering\");\n\n  $id = mysql_real_escape_string(trim($_POST['id']));\n  $ps = mysql_real_escape_string(trim($_POST['ps']));\n\n  $row=mysql_fetch_array(mysql_query(\"select * from user where id='$id' and ps=md5('$ps')\"));\n\n  if(isset($row['id'])){\n   if($id=='guest' || $id=='blueh4g'){\n    echo \"your account is blocked\";\n   }else{\n    echo \"login ok\".\"<br />\";\n    echo \"Password : \".$key;\n   }\n  }else{\n   echo \"wrong..\";\n  }\n }\n?>\n```\n코드를 볼 때 php 코드만 자세히 보고 맨 밑 코드를 못봤었다.\n\n```php\n<!--\n\nyou have blocked accounts.\n\nguest / guest\nblueh4g / blueh4g1234ps\n\n-->\n```\n\n이렇게 주석처리 된 부분에 로그인 id와 password를 적어놓았다.\n일단 입력받은 id가 guest 이거나 blueh4g 이면 `your account is blocked`\n쿼리상에선 알파벳의 대소문자 구분이 없고, php상에선 그대로 인식하므로 Guest 같이 대소문자를 섞어서 id를 입력하면 된다.\nGuest 뿐만 아니라 Blueh4g도 가능. 패스워드는 그대로 입력해준다.\n로그인에 성공하면 Password가 뜨고, 인증하면 된다.\n\n![](/assets/posts/wargamekr/login-filtering-clear.png)\n","layout":"post","title":"[Wargame.kr] login filtering","categories":["Wargame"],"excerpt":" ","comments":true,"share":true,"tags":["Wargame.kr","Web-hacking","login filtering","write-up"]}},"__N_SSG":true}