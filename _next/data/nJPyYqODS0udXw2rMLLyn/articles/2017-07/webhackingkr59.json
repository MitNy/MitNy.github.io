{"pageProps":{"post":{"slug":"2017-07-30-webhackingkr59","content":"\n```php\n<?\n\nif($_POST[lid] && $_POST[lphone])\n{\n$q=@mysql_fetch_array(mysql_query(\"select id,lv from c59 where id='$_POST[lid]' and phone='$_POST[lphone]'\"));\n\nif($q[id])\n{\n\necho(\"id : $q[id]<br>lv : $q[lv]<br><br>\");\n\nif($q[lv]==\"admin\")\n{\n@mysql_query(\"delete from c59\");\n@clear();\n}\n\necho(\"<br><a href=index.php>back</a>\");\nexit();\n}\n\n}\n\n\nif($_POST[id] && $_POST[phone])\n{\nif(strlen($_POST[phone])>=20) exit(\"Access Denied\");\nif(eregi(\"admin\",$_POST[id])) exit(\"Access Denied\");\nif(eregi(\"admin|0x|#|hex|char|ascii|ord|from|select|union\",$_POST[phone])) exit(\"Access Denied\");\n\n@mysql_query(\"insert into c59 values('$_POST[id]',$_POST[phone],'guest')\");\n}\n\n?>\n```\n\n이 문제의 소스를 보면 lv가 admin일 때 문제가 풀리게 된다,\n`insert into c59 values('$_POST[id]',$_POST[phone],'guest')`\n예상되는 풀이는 insert into c59 values('~~~',~~~,'admin') 인듯하다\n\n![](/assets/posts/webhackingkr/59_main.png)\n\n59번은 이렇게 JOIN 과 LOGIN이 있다. 아무거나 아이디와 패스워드를 쳐서 JOIN을 한 후 로그인 하면\n\n![](/assets/posts/webhackingkr/59_guest.png)\nid는 입력한 것 그대로, lv는 guest가 뜬다.\n\n![](/assets/posts/webhackingkr/59_lv.png)\n`insert into c59 values('qqq',1,123)-- 'guest')`\n\n이런식으로 guest부분을 주석처리 해버리면\n![](/assets/posts/webhackingkr/59_lv123.png)\n\nlv가  123으로 바뀐다.\n\nreverse 함수는 인자로 들어온 값을 반대로 출력하는데, 이 함수를 사용해 보자\nmitny    1,reverse(id))) -- 이런식으로 입력하면 lv에는 mitny를 반대로 한 값이 들어간다\n![](/assets/posts/webhackingkr/59_reverse.png)\n\n그럼 admin을 반대로 한 nimda를 id값으로 주고 reverse함수를 사용하면\n![](/assets/posts/webhackingkr/59_nimda.png)\n\nlv가 admin으로 바뀌고 문제가 풀린다\n\n![](/assets/posts/webhackingkr/59_done.png)\n\n","layout":"post","title":"[Webhacking.kr] 59","categories":["Webhacking.kr"],"excerpt":" ","comments":true,"share":true,"tags":["Web-hacking","webhacking.kr","write-up"]}},"__N_SSG":true}