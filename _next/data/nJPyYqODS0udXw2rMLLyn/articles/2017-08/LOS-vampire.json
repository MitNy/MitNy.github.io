{"pageProps":{"post":{"slug":"2017-08-21-LOS-vampire","content":"\n### https://los.eagle-jump.org/ 버전\n![](/assets/posts/los/vampire.png)\n\n`query : select id from prob_vampire where id=''`\n```php\n<?php \n  include \"./config.php\"; \n  login_chk(); \n  dbconnect(); \n  if(preg_match('/\\'/i', $_GET[id])) exit(\"No Hack ~_~\"); \n  $_GET[id] = str_replace(\"admin\",\"\",$_GET[id]); \n  $query = \"select id from prob_vampire where id='{$_GET[id]}'\"; \n  echo \"<hr>query : <strong>{$query}</strong><hr><br>\"; \n  $result = @mysql_fetch_array(mysql_query($query)); \n  if($result['id'] == 'admin') solve(\"vampire\"); \n  highlight_file(__FILE__); \n?>\n```\nvampire 문제는 id에 admin이 들어오면 공백으로 바꿔버린다. 아래 str_replace 때문이다.\n`$_GET[id] = str_replace(\"admin\",\"\",$_GET[id]);`\n\n![](/assets/posts/los/vampire_admin.png)\n\n이렇게 ?id=admin 을 해버리면 쿼리문 안의 id에는 아무 것도 들어있지 않게 된다.\n이 문제도 대소문자로 우회해 풀 수 있다.\n\nAdmin,ADMIN,aDmin 등등.. 한 글자 또는 전체를 대문자로 바꿔버리면 된다.\n\n![](/assets/posts/los/vampire_clear.png)\n\n\n### https://los.rubiya.kr 버전\n비슷한 문제이지만 위와 같이 단순히 대소문자 만으로는 풀리지 않는다.\nstr_replace() 취약점 중 하나를 이용해서\n`?id=adadminmin`를 입력하면 ad'admin'min 에서 admin이 제거되어 `?id=admin`이 필터링 되지 않는다.\n![](/assets/posts/los/vampire_2_clear.png)\n\n","layout":"post","title":"[LOS] vampire","categories":["LOS"],"excerpt":" ","comments":true,"share":true,"tags":["LOS","Web-hacking","vampire","write-up"]}},"__N_SSG":true}