{"pageProps":{"post":{"slug":"2017-08-30-Wargamekr-md5-compare","content":"![](/assets/posts/wargamekr/wargamekr.png)\n\n![](/assets/posts/wargamekr/md_compare.png)\n\nmd5_compare 는 VALUE1 과 VALUE2 를 비교해서 같으면 된다.\n코드를 보면 다음과 같다.\n\n```php\n<?php\n    if (isset($_GET['view-source'])) {\n         show_source(__FILE__);\n         exit();\n    }\n\n    if (isset($_GET['v1']) && isset($_GET['v2'])) {\n        sleep(3); // anti brute force\n\n        $chk = true;\n        $v1 = $_GET['v1'];\n        $v2 = $_GET['v2'];\n\n        if (!ctype_alpha($v1)) {$chk = false;}\n        if (!is_numeric($v2) ) {$chk = false;}\n        if (md5($v1) != md5($v2)) {$chk = false;}\n\n        if ($chk){\n            include(\"../lib.php\");\n            echo \"Congratulations! FLAG is : \".auth_code(\"md5_compare\");\n        } else {\n            echo \"Wrong...\";\n        }\n    }\n?>\n```\n\nv1는 알파벳이어야 하고, v2는 숫자여야 한다.\n그리고 그 둘을 md5화 했을 때, 다르면 false, 같으면 chk를 해서 flag를 출력한다.\n\nPHP는 int형과 char형을 구분하여 선언하지 않는다고 한다.\nmd5 해싱을 할 때 해쉬값이 `0e****` 인 경우 두 값을 비교하면 무조건 참이 된다.\n\n![](/assets/posts/wargamekr/md_compare_stack.png)\n\nstack overflow의 위 답변을 참고하여\nVALUE1에는 QNKCDZO를, VALUE2에는 240610708을 넣어봤더니 문제가 풀렸다.\n\n![](/assets/posts/wargamekr/md_compare_clear.png)\n","layout":"post","title":"[Wargame.kr] md5_compare","categories":["Wargame"],"excerpt":" ","comments":true,"share":true,"tags":["Wargame.kr","Web-hacking","write-up"]}},"__N_SSG":true}