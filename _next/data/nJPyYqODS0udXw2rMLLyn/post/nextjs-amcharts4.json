{"pageProps":{"post":{"slug":"nextjs-amcharts4","content":"\n<img src=\"/posts/nextjs-amcharts4/amcharts-light-opaque.png\" width=\"500px\" />\n\n[amcharts4](https://www.amcharts.com/docs/v4/)\n<br>지도, 그래프 등 다양한 시각화 기능을 제공한다.<br>\n현재는 라이선스를 구매해서 사용하고 있는데, 라이선스가 없는 경우 워터마크가 화면에 표시된다.\n\n\n기존에는 이렇게 js 파일을 추가해서 사용했는데\n\n```js\n<script src=\"/js/amcharts4/core.js\"></script>\n<script src=\"/js/amcharts4/maps.js\"></script>\n<script src=\"/js/amcharts4/charts.js\"></script>\n...\n```\n\nNext.js에서 사용하려면 npm 또는 yarn으로 설치해주면 된다.\n```bash\nnpm install @amcharts/amcharts4\n\nyarn add @amcharts/amcharts4\n```\n\n설치 후 사용하려는 곳에서 import를 해주면 된다.\n```js\nimport * as am4core from \"@amcharts/amcharts4/core\";\nimport * as am4charts from \"@amcharts/amcharts4/charts\";\n```\n\n<br><br>\n\n## run... 그리고 error\n\nimport 후 차트가 보이길 기대하면서 npm run을 했는데... 에러가 떴다\n\n```bash\nerror - ~~/node_modules/@amcharts/amcharts4/core.js:8\nexport { System, system } from \"./.internal/core/System\";\n^^^^^^\n\nSyntaxError: Unexpected token 'export'\n    at Object.compileFunction (node:vm:360:18)\n    at wrapSafe (node:internal/modules/cjs/loader:1055:15)\n    at Module._compile (node:internal/modules/cjs/loader:1090:27)\n    at Object.Module._extensions..js (node:internal/modules/cjs/loader:1180:10)\n    at Module.load (node:internal/modules/cjs/loader:1004:32)\n    at Function.Module._load (node:internal/modules/cjs/loader:839:12)\n    at Module.require (node:internal/modules/cjs/loader:1028:19)\n    at require (node:internal/modules/cjs/helpers:102:18)\n    at Object.@amcharts/amcharts4/core (~~~/.next/server/pages/index.js:62:18)\n    at __webpack_require__ (~~~/.next/server/webpack-runtime.js:33:42) {\n  page: '/'\n}\n```\n\namCharts 모듈을 포함해서 transpile 하기 위해 `next-transpile-modules`를 설치해줘야 한다.\n\n```bash\nnpm install next-transpile-modules\n```\n\n설치 후 next.config.js도 수정해야 한다.\n```js\nconst withTM = require(\"next-transpile-modules\")([\"@amcharts/amcharts4\"]);\n\nmodule.exports = withTM({\n// any other general next.js settings\n// EX\n  reactStrictMode: false,\n  webpack: (config, { isServer, node }) => {\n    node = {\n      ...\n    };\n    return config;\n  }\n})\n```\n\n기존에 사용하던 config 내용들은 withTM 안에 작성해주면 된다.\n\n\n## Pie Chart 예제 추가 해보기\n\n```js\n// components/Charts.ts\nimport { useEffect } from \"react\";\nimport * as am4core from \"@amcharts/amcharts4/core\";\nimport * as am4charts from \"@amcharts/amcharts4/charts\";\n\nexport default function PieChart() {\n\tuseEffect(() => {\n\t\tlet chart = am4core.create(\"chartdiv\", am4charts.PieChart);\n\t\t\n\t\t// Add data\n\t\tchart.data = [\n\t\t\t{\n\t\t\t\t\"country\": \"Lithuania\",\n\t\t\t\t\"litres\": 501.9\n\t\t\t}, {\n\t\t\t\t\"country\": \"Czech Republic\",\n\t\t\t\t\"litres\": 301.9\n\t\t\t}, {\n\t\t\t\t\"country\": \"Ireland\",\n\t\t\t\t\"litres\": 201.1\n\t\t\t}, {\n\t\t\t\t\"country\": \"Germany\",\n\t\t\t\t\"litres\": 165.8\n\t\t\t}, {\n\t\t\t\t\"country\": \"Australia\",\n\t\t\t\t\"litres\": 139.9\n\t\t\t}, {\n\t\t\t\t\"country\": \"Austria\",\n\t\t\t\t\"litres\": 128.3\n\t\t\t}, {\n\t\t\t\t\"country\": \"UK\",\n\t\t\t\t\"litres\": 99\n\t\t\t}, {\n\t\t\t\t\"country\": \"Belgium\",\n\t\t\t\t\"litres\": 60\n\t\t\t}, {\n\t\t\t\t\"country\": \"The Netherlands\",\n\t\t\t\t\"litres\": 50\n\t\t\t}\n\t\t];\n\n\t\t// Add and configure Series\n\t\tlet pieSeries = chart.series.push(new am4charts.PieSeries());\n\t\tpieSeries.dataFields.value = \"litres\";\n\t\tpieSeries.dataFields.category = \"country\";\n\t\t/**\n \t    * Destroying map on leave page.\n \t    */\n\t    return () => {\n\t\t\tchart.dispose();\n\t\t};\n\t}, []);\n\n\treturn (\n\t\t<div\n\t\t\tid=\"chartdiv\"\n\t\t\tstyle={{\n\t\t\t\twidth: \"60%\",\n\t\t\t\theight: \"300px\"\n\t\t\t}}\n\t\t/>\n\t);\n}\n```\n\n```js\n// pages/chart.tsx\n\n...\nimport PieChart from \"../components/Charts\";\n\nexport default const Chart = () => {\n\treturn (\n\t\t<>\n\t\t\t<PieChart />\n\t\t</>\n\t)\n}\n```\n\n## Pie Chart 예제 결과\n\n<img src=\"/posts/nextjs-amcharts4/amcharts4-pie-sample.png\" width=\"500px\"/>\n","title":"amCharts4 적용하기 with Next.js","description":"기존에 PHP와 Javascript ES5로 사용하고 있던 amCharts4를 Next.js에서 사용 해보기","date":"2022-09-21"}},"__N_SSG":true}